{"version":3,"sources":["webpack:///./demo/index.js","webpack:///./demo/AnimateContainer.js","webpack:///./src/WebDesignDndProvider.js","webpack:///./src/Model/index.js","webpack:///./src/DropContainer/index.js","webpack:///./src/DropContainer/DropContainer.js","webpack:///./src/DropContainer/DropItem.js","webpack:///./src/utils/index.js","webpack:///./src/WidgetItem/index.js","webpack:///./src/DragLayer/index.js","webpack:///./demo/DropContainerDemo.js","webpack:///./demo/DropContainerWithChildDemo.js","webpack:///./demo/widgets/index.js","webpack:///./demo/widgets/TextField/index.js","webpack:///./demo/widgets/TextareaField/index.js","webpack:///./demo/widgets/SelectField/index.js","webpack:///./demo/widgets/CheckboxField/index.js","webpack:///./demo/widgets/RadioField/index.js","webpack:///./src/ModelContext.js","webpack:///./src/index.js","webpack:///./src/constants.js"],"names":["_react","_interopRequireDefault","__webpack_require__","_reactDom","_AnimateContainer","_DropContainerDemo","_DropContainerWithChildDemo","_src","_widgets","idx","DragLayerDemo","default","createElement","DragLayer","_ref","isDragging","style","padding","background","position","top","right","ReactDOM","render","_React$useState","React","useState","items","_React$useState2","_slicedToArray2","metadata","onMetadataChange","WebDesignDndProvider","value","onChange","onDragStart","ev","console","log","onDragEnd","onDrop","display","left","bottom","width","flex","widgets","map","widget","WidgetItem","key","xtype","getInstance","_objectSpread2","id","Math","random","toString","slice","pid","index","_ref2","connectDragTarget","ref","height","lineHeight","title","canDrop","item","document","getElementById","DropContainer","monitor","list","_toConsumableArray2","sort","a","b","border","pos","i","length","getPositionIndex","DropItem","connectDragAndDrop","isOver","isHover","isTmp","transition","transform","concat","zIndex","opacity","_reactDndHtml5Backend","_reactDnd","_Model","model","_this","this","_this$props","props","children","backend","_objectWithoutProperties2","DndProvider","_extends2","saveModel","Component","HTML5Backend","_propTypes","_ModelContext","_find","_findIndex","randomStr","arguments","undefined","normalizeItem","idField","pidField","WebDesignModel","createContext","isRootContainer","scope","setState","state","eventName","handler","getAllItems","filter","_this$props2","pids","node","getItem","pNode","currentFieldId","push","getItemIndex","s1","s2","_this$props3","indexField","__tmp__","__dragging__","addItem","_this2","ret","shouldRemove","getPids","indexOf","bItem","_this$props4","_idx","prevItem","oIdx","splice","_this$props5","nextItem","newItems","_this$props6","pidIndex","childs","getChildren","firstItem","lastItem","insertAfter","insertBefore","_create","Provider","getModel","forEach","propTypes","array","align","oneOf","func","_DropContainer","_DropItem","_withComponentHooks","_invariant","_constants","disabled","dom","findDOMNode","_connectDropTarget","connectDrop","_this$props$pid","hover","drop","collect","designer","useContext","ModelContext","DropContainerContext","_useDrop","useDrop","accept","getScope","fireEvent","target","shallow","updateItemPid","_ref3","isTmpItem","action","ACTION_ADD","ACTION_SORT","commitItem","ext","isStrictlyOver","_useDrop2","collectedProps","connectDropTarget","getItems","child","Children","only","any","bool","_utils","self","dragItem","isSameItem","canDropRet","dragOffset","getClientOffset","targetOffset","getBoundingClientRect","middleX","middleY","shouldInsertBefore","y","x","isBeforeRect","canDrag","beginDrag","endDrag","type","begin","setItemDragging","end","clearTmpItems","getDropOptions","collectedDropProps","_useDrag","useDrag","getDragOptions","_useDrag2","collectedDragProps","connectDragPreview","isRequired","object","getRectDirection","px","py","y_ac","y_bd","middle_x","middle_y","apply","addTmpItem","collectProps","useDragLayer","getItemType","initialClientOffset","getInitialClientOffset","initialSourceClientOffset","getInitialSourceClientOffset","clientOffset","differenceFromInitialOffset","getDifferenceFromInitialOffset","sourceClientOffset","getSourceClientOffset","_ref$pid","margin","_ref4","overflow","_ref5","_TextField","_TextareaField","_SelectField","_CheckboxField","_RadioField","TextField","TextareaField","SelectField","CheckboxField","RadioField","_WebDesignDndProvider","_WidgetItem","_DragLayer","WebDesignContext"],"mappings":"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","file":"js/index.7ec5db8a.chunk.js","sourcesContent":["import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\nimport AnimateContainer from \"./AnimateContainer\";\r\n\r\nimport DropContainerDemo from \"./DropContainerDemo\";\r\nimport DropContainerWithChildDemo from \"./DropContainerWithChildDemo\";\r\n\r\nimport { WebDesignDndProvider, WidgetItem, DragLayer } from \"../src\";\r\n\r\nimport widgets from \"./widgets\";\r\n\r\nfunction randomStr() {\r\n    return Math.random()\r\n        .toString(16)\r\n        .slice(2, 8);\r\n}\r\n\r\nlet idx = 1;\r\n\r\nfunction DragLayerDemo() {\r\n    return (\r\n        <DragLayer>\r\n            {({ isDragging }) =>\r\n                !isDragging ? null : (\r\n                    <div\r\n                        style={{\r\n                            padding: 5,\r\n                            background: \"rgba(0,0,0,.2)\",\r\n                            position: \"fixed\",\r\n                            top: 0,\r\n                            right: 0\r\n                        }}>\r\n                        dragLayer: isDragging...\r\n                    </div>\r\n                )\r\n            }\r\n        </DragLayer>\r\n    );\r\n}\r\n\r\nfunction App() {\r\n    const [metadata, onMetadataChange] = React.useState({\r\n        items: []\r\n    });\r\n\r\n    function onChange(items) {\r\n        onMetadataChange({\r\n            items\r\n        });\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <WebDesignDndProvider\r\n                // 受控\r\n                value={metadata.items}\r\n                onChange={onChange}\r\n                onDragStart={ev => {\r\n                    console.log(\"onDragStart\", ev);\r\n                }}\r\n                onDragEnd={ev => {\r\n                    console.log(\"onDragEnd\", ev);\r\n                }}\r\n                onDrop={ev => {\r\n                    console.log(\"onDrop\", ev);\r\n                }}>\r\n                <div\r\n                    style={{\r\n                        display: \"flex\",\r\n                        position: \"fixed\",\r\n                        top: 0,\r\n                        left: 0,\r\n                        right: 0,\r\n                        bottom: 0\r\n                    }}>\r\n                    <div\r\n                        style={{\r\n                            width: 240,\r\n                            flex: \"none\"\r\n                        }}>\r\n                        {widgets.map(widget => {\r\n                            return (\r\n                                <WidgetItem\r\n                                    key={widget.xtype}\r\n                                    // disabled={widget.xtype === \"EX_URL_FIELD\"}\r\n                                    getInstance={() => ({\r\n                                        ...widget,\r\n                                        id: randomStr(),\r\n                                        pid: null,\r\n                                        index: idx++\r\n                                    })}>\r\n                                    {({ connectDragTarget }) => (\r\n                                        <div\r\n                                            ref={connectDragTarget}\r\n                                            style={{\r\n                                                height: 32,\r\n                                                lineHeight: `32px`,\r\n                                                padding: \"0 20px\"\r\n                                            }}>\r\n                                            {widget.title}\r\n                                        </div>\r\n                                    )}\r\n                                </WidgetItem>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                    <DropContainerDemo title=\"A\" />\r\n                    <DropContainerDemo pid=\"b\" title=\"B\" />\r\n                    <AnimateContainer />\r\n\r\n                    <DropContainerWithChildDemo title=\"Parent\" />\r\n                    <DropContainerDemo\r\n                        pid=\"d\"\r\n                        title=\"D\"\r\n                        canDrop={item => {\r\n                            return item.xtype === \"EX_TEXTAREA_FIELD\";\r\n                        }}\r\n                    />\r\n                    <DragLayerDemo />\r\n                </div>\r\n            </WebDesignDndProvider>\r\n        </div>\r\n    );\r\n}\r\n\r\nReactDOM.render(<App />, document.getElementById(\"root\"));\r\n","import React from \"react\";\r\nimport { DropContainer, DropItem } from \"../src\";\r\n\r\nexport default function AnimateContainer() {\r\n    return (\r\n        <DropContainer pid=\"Animate\">\r\n            {(items, { monitor, canDrop }) => {\r\n                const list = [...items];\r\n                list.sort((a, b) => a.index - b.index);\r\n\r\n                function getPositionIndex(index) {\r\n                    for (let i = 0; i < items.length; i++) {\r\n                        const item = items[i];\r\n                        if (item.index === index) return i;\r\n                    }\r\n                }\r\n\r\n                return (\r\n                    <div\r\n                        style={{\r\n                            position: \"relative\",\r\n                            border: canDrop\r\n                                ? \"1px solid green\"\r\n                                : \"1px solid #ccc\",\r\n                            flex: 1\r\n                        }}>\r\n                        <h3>Animate</h3>\r\n                        <hr />\r\n                        <div\r\n                            style={{\r\n                                position: \"relative\"\r\n                            }}>\r\n                            <div\r\n                                style={{\r\n                                    position: \"relative\"\r\n                                }}>\r\n                                {list.map((item, index) => {\r\n                                    var pos = getPositionIndex(item.index);\r\n\r\n                                    return (\r\n                                        <DropItem key={item.id} item={item}>\r\n                                            {({\r\n                                                connectDragAndDrop,\r\n                                                isDragging,\r\n                                                isHover,\r\n                                                isOver,\r\n                                                isTmp\r\n                                            }) => {\r\n                                                return (\r\n                                                    <div\r\n                                                        ref={connectDragAndDrop}\r\n                                                        key={item.id}\r\n                                                        id={item.id}\r\n                                                        style={{\r\n                                                            transition:\r\n                                                                \"transform .2s cubic-bezier(0.2, 0, 0, 1)\",\r\n                                                            position:\r\n                                                                \"absolute\",\r\n                                                            left: 5,\r\n                                                            right: 5,\r\n                                                            transform: `translate(0, ${(30 +\r\n                                                                18) *\r\n                                                                pos}px)`,\r\n                                                            zIndex: isDragging\r\n                                                                ? 2\r\n                                                                : 1,\r\n                                                            opacity: isDragging\r\n                                                                ? 0.5\r\n                                                                : 1,\r\n                                                            padding: 10,\r\n                                                            background:\r\n                                                                \"#f2f2f2\",\r\n                                                            border:\r\n                                                                isOver &&\r\n                                                                !isDragging\r\n                                                                    ? \"1px solid green\"\r\n                                                                    : \"1px solid #dadada\"\r\n                                                        }}>\r\n                                                        {item.title}({item.id})\r\n                                                    </div>\r\n                                                );\r\n                                            }}\r\n                                        </DropItem>\r\n                                    );\r\n                                })}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                );\r\n            }}\r\n        </DropContainer>\r\n    );\r\n}\r\n","import React from \"react\";\r\nimport HTML5Backend from \"react-dnd-html5-backend\";\r\nimport { DndProvider } from \"react-dnd\";\r\n\r\nimport Model from \"./Model\";\r\n\r\nexport default class WebDesignDndProvider extends React.Component {\r\n    static defaultProps = {\r\n        backend: HTML5Backend\r\n    };\r\n\r\n    model = null;\r\n\r\n    getModel() {\r\n        return this.model;\r\n    }\r\n\r\n    saveModel = model => {\r\n        this.model = model;\r\n    };\r\n\r\n    render() {\r\n        const { children, backend, ...props } = this.props;\r\n\r\n        return (\r\n            <DndProvider backend={backend}>\r\n                <Model {...props} ref={this.saveModel}>\r\n                    {children}\r\n                </Model>\r\n            </DndProvider>\r\n        );\r\n    }\r\n}\r\n","import React from \"react\";\r\nimport propTypes from \"prop-types\";\r\nimport ModelContext from \"../ModelContext\";\r\n\r\nimport find from \"lodash/find\";\r\nimport findIndex from \"lodash/findIndex\";\r\n\r\nfunction randomStr(prefix = \"\") {\r\n    return (\r\n        prefix +\r\n        Math.random()\r\n            .toString(16)\r\n            .slice(2, 8)\r\n    );\r\n}\r\n\r\nfunction normalizeItem(item, props) {\r\n    const idField = props.idField;\r\n    const pidField = props.pidField;\r\n\r\n    item[idField] =\r\n        item[idField] === undefined ? randomStr(`item_`) : item[idField];\r\n\r\n    item[pidField] = item[pidField] === undefined ? null : item[pidField];\r\n\r\n    return item;\r\n}\r\n\r\nexport default class WebDesignModel extends React.Component {\r\n    static propTypes = {\r\n        value: propTypes.array,\r\n        align: propTypes.oneOf([\"all\", \"vertical\", \"horizontal\"]),\r\n        onChange: propTypes.func,\r\n        onDragStart: propTypes.func,\r\n        onDragEnd: propTypes.func,\r\n        onDrop: propTypes.func\r\n    };\r\n\r\n    static getDerivedStateFromProps(props, state) {\r\n        if (props.value) {\r\n            props.value.forEach(item => normalizeItem(item, props));\r\n        }\r\n        return {\r\n            items: \"value\" in props ? props.value : state.items\r\n        };\r\n    }\r\n\r\n    static defaultProps = {\r\n        idField: \"id\",\r\n        pidField: \"pid\",\r\n        indexField: \"index\",\r\n        align: \"vertical\",\r\n        onChange: null\r\n    };\r\n\r\n    DropContainerContext = React.createContext({\r\n        isRootContainer: true,\r\n        canDrop: null\r\n    });\r\n\r\n    state = {\r\n        scope: randomStr(\"scope_\"),\r\n        items: []\r\n    };\r\n\r\n    onChange(items) {\r\n        const props = this.props;\r\n        const { onChange } = props;\r\n\r\n        if (!(\"value\" in props)) {\r\n            this.setState({\r\n                items\r\n            });\r\n        }\r\n\r\n        if (onChange) {\r\n            onChange(items);\r\n        }\r\n    }\r\n\r\n    getScope() {\r\n        return this.state.scope;\r\n    }\r\n\r\n    fireEvent(eventName, ev) {\r\n        const { onDragStart, onDragEnd, onDrop } = this.props;\r\n\r\n        const events = {\r\n            onDragStart,\r\n            onDragEnd,\r\n            onDrop\r\n        };\r\n\r\n        const handler = events[eventName];\r\n\r\n        if (handler) {\r\n            handler(ev);\r\n        }\r\n    }\r\n\r\n    getItems(pid = null) {\r\n        const { pidField } = this.props;\r\n        const items = this.getAllItems();\r\n\r\n        return items.filter(item => item && item[pidField] == pid);\r\n    }\r\n\r\n    getChildren(id = null, items = this.state.items) {\r\n        const { pidField } = this.props;\r\n        return items.filter(item => item[pidField] == id);\r\n    }\r\n\r\n    getAllItems() {\r\n        return [...this.state.items];\r\n    }\r\n\r\n    //获取组件的所有父级ID\r\n    getPids(id) {\r\n        const { idField, pidField } = this.props;\r\n        const pids = [];\r\n        let node = this.getItem(id);\r\n\r\n        if (!node) return pids;\r\n\r\n        if (!node[pidField]) return pids;\r\n\r\n        let currentFieldId = node[pidField];\r\n        let pNode;\r\n        while ((pNode = this.getItem(currentFieldId))) {\r\n            pids.push(pNode[idField]);\r\n            currentFieldId = pNode[pidField];\r\n            if (!currentFieldId) break;\r\n        }\r\n\r\n        return pids;\r\n    }\r\n\r\n    updateItem(item) {\r\n        const { idField } = this.props;\r\n        const items = this.getAllItems();\r\n        const id = item[idField];\r\n        const idx = this.getItemIndex(id);\r\n\r\n        if (idx !== -1) {\r\n            items[idx] = item;\r\n        }\r\n\r\n        this.onChange(items);\r\n    }\r\n\r\n    isSameItem(s1, s2) {\r\n        const { idField } = this.props;\r\n\r\n        return s1[idField] === s2[idField];\r\n    }\r\n\r\n    addItem(item, pid = null) {\r\n        const { pidField, indexField } = this.props;\r\n        item = normalizeItem(item, this.props);\r\n\r\n        const items = this.getAllItems();\r\n\r\n        item[pidField] = pid;\r\n\r\n        items.push(item);\r\n\r\n        this.onChange(items);\r\n    }\r\n\r\n    addTmpItem(item, pid) {\r\n        item.__tmp__ = true;\r\n        item.__dragging__ = true;\r\n        this.addItem(item, pid);\r\n    }\r\n\r\n    setItemDragging(item) {\r\n        item.__dragging__ = true;\r\n\r\n        this.onChange(this.getAllItems());\r\n    }\r\n\r\n    removeItem(id) {\r\n        const { idField } = this.props;\r\n        const items = this.getAllItems();\r\n        //移除指定项目及子项目\r\n        const ret = items.filter(item => {\r\n            let shouldRemove = item[idField] === id;\r\n\r\n            if (!shouldRemove) {\r\n                const pids = this.getPids(item[idField]);\r\n                shouldRemove = pids.indexOf(id) > -1;\r\n            }\r\n\r\n            return !shouldRemove;\r\n        });\r\n\r\n        this.onChange(ret);\r\n    }\r\n\r\n    getItemIndex(id, items) {\r\n        const { idField } = this.props;\r\n        items = items || this.getAllItems();\r\n        return findIndex(items, item => item[idField] === id);\r\n    }\r\n\r\n    getItem(id) {\r\n        const { idField } = this.props;\r\n        const items = this.getAllItems();\r\n        return find(items, item => item && item[idField] === id);\r\n    }\r\n\r\n    insertBefore(item, bItem) {\r\n        const { idField, pidField } = this.props;\r\n        const items = this.getAllItems();\r\n        const id = bItem[idField];\r\n        // const bItem = this.getItem(id);\r\n\r\n        //判断是否需要移动\r\n        const _idx = this.getItemIndex(id);\r\n        if (_idx !== 0) {\r\n            const prevItem = items[_idx - 1];\r\n            if (\r\n                prevItem[idField] === item[idField] &&\r\n                prevItem[pidField] === bItem[pidField]\r\n            ) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        //判断当前item是否已经存在, 如果存在则先删除\r\n        const oIdx = this.getItemIndex(item[idField]);\r\n        if (oIdx > -1) {\r\n            items.splice(oIdx, 1);\r\n        }\r\n\r\n        item[pidField] = bItem[pidField];\r\n\r\n        //插入操作\r\n        const idx = this.getItemIndex(id, items);\r\n        items.splice(idx, 0, item);\r\n\r\n        this.onChange(items);\r\n    }\r\n\r\n    insertAfter(item, prevItem) {\r\n        const { idField, pidField } = this.props;\r\n        const items = this.getAllItems();\r\n        const id = prevItem[idField];\r\n        // const prevItem = this.getItem(id);\r\n\r\n        //判断是否需要移动\r\n        const _idx = this.getItemIndex(id);\r\n        if (_idx !== items.length - 1) {\r\n            const nextItem = items[_idx + 1];\r\n            if (\r\n                nextItem[idField] === item[idField] &&\r\n                nextItem[pidField] === prevItem[pidField]\r\n            ) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        //判断当前item是否已经存在, 如果存在则先删除\r\n        const oIdx = this.getItemIndex(item[idField]);\r\n        if (oIdx > -1) {\r\n            items.splice(oIdx, 1);\r\n        }\r\n\r\n        item[pidField] = prevItem[pidField];\r\n\r\n        //插入操作 之前有删除操作, 要重新查找index\r\n        const idx = findIndex(items, item => item[idField] === id);\r\n        items.splice(idx, 1, items[idx], item);\r\n\r\n        this.onChange(items);\r\n    }\r\n\r\n    clearTmpItems() {\r\n        const items = this.getAllItems();\r\n        const newItems = items\r\n            .map(item => {\r\n                if (item.__dragging__) {\r\n                    delete item.__dragging__;\r\n                }\r\n                return item;\r\n            })\r\n            .filter(item => !item.__tmp__);\r\n\r\n        this.onChange(newItems);\r\n    }\r\n\r\n    updateItemPid(item, pid = null) {\r\n        const { idField, pidField } = this.props;\r\n        const id = item[idField];\r\n        const idx = this.getItemIndex(id);\r\n\r\n        if (item[pidField] === pid) return true;\r\n\r\n        /**\r\n         * 局部环路检测\r\n         * 如: {id: A, pid: null}  {id: B, pid: A}\r\n         * 这是如果updateItemPid(A, B) 结果为:\r\n         * {id: A, pid: B}  {id: B, pid: A}\r\n         *\r\n         */\r\n        const pids = pid == null ? [] : this.getPids(pid);\r\n        if (pids.length) {\r\n            if (pids.indexOf(id) !== -1) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // 同级节点转变为子节点时顺序处理\r\n        if (pid) {\r\n            const pidIndex = this.getItemIndex(pid);\r\n            const childs = this.getChildren(pid);\r\n\r\n            if (childs.length) {\r\n                const firstItem = childs[0];\r\n                const lastItem = childs[childs.length - 1];\r\n\r\n                if (idx > pidIndex) {\r\n                    this.insertAfter(item, lastItem);\r\n                } else {\r\n                    this.insertBefore(item, firstItem);\r\n                }\r\n                return true;\r\n            }\r\n        }\r\n\r\n        if (idx !== -1) {\r\n            item[pidField] = pid;\r\n        }\r\n\r\n        this.onChange(this.getAllItems());\r\n\r\n        return true;\r\n    }\r\n\r\n    commitItem(item) {\r\n        const { idField } = this.props;\r\n        const items = this.getAllItems();\r\n        const id = item[idField];\r\n        const idx = this.getItemIndex(id);\r\n\r\n        if (idx !== -1 && item.__tmp__) {\r\n            item.__tmp__ = false;\r\n            delete item.__tmp__;\r\n            items[idx] = item;\r\n\r\n            this.onChange(items);\r\n        }\r\n    }\r\n\r\n    isTmpItem(item) {\r\n        return !!item.__tmp__;\r\n    }\r\n\r\n    isDragging(item) {\r\n        return !!item.__dragging__;\r\n    }\r\n\r\n    getModel() {\r\n        return Object.create(this);\r\n        // return {\r\n        //     DropContainerContext: this.DropContainerContext,\r\n        //     isSameItem: this.isSameItem.bind(this),\r\n        //     getScope: this.getScope.bind(this),\r\n        //     fireEvent: this.fireEvent.bind(this),\r\n        //     addItem: this.addItem.bind(this),\r\n        //     addTmpItem: this.addTmpItem.bind(this),\r\n        //     getPids: this.getPids.bind(this),\r\n        //     updateItem: this.updateItem.bind(this),\r\n        //     getItems: this.getItems.bind(this),\r\n        //     getAllItems: this.getAllItems.bind(this),\r\n        //     removeItem: this.removeItem.bind(this),\r\n        //     getItemIndex: this.getItemIndex.bind(this),\r\n        //     getItem: this.getItem.bind(this),\r\n        //     insertBefore: this.insertBefore.bind(this),\r\n        //     insertAfter: this.insertAfter.bind(this),\r\n        //     clearTmpItems: this.clearTmpItems.bind(this),\r\n        //     commitItem: this.commitItem.bind(this),\r\n        //     isTmpItem: this.isTmpItem.bind(this),\r\n        //     updateItemPid: this.updateItemPid.bind(this),\r\n        //     setItemDragging: this.setItemDragging.bind(this),\r\n        //     isDragging: this.isDragging.bind(this)\r\n        // };\r\n    }\r\n\r\n    render() {\r\n        const { children } = this.props;\r\n\r\n        return (\r\n            <ModelContext.Provider value={this.getModel()}>\r\n                {children}\r\n            </ModelContext.Provider>\r\n        );\r\n    }\r\n}\r\n","import DropContainer from \"./DropContainer\";\r\nimport DropItem from \"./DropItem\";\r\n\r\nexport { DropContainer, DropItem };\r\n","import React from \"react\";\r\nimport { findDOMNode } from \"react-dom\";\r\nimport { useDrop } from \"react-dnd\";\r\nimport propTypes from \"prop-types\";\r\nimport withHooks from \"with-component-hooks\";\r\nimport invariant from \"invariant\";\r\nimport { ACTION_ADD, ACTION_SORT } from \"../constants\";\r\nimport ModelContext from \"../ModelContext\";\r\n\r\nclass DropContainer extends React.Component {\r\n    static propTypes = {\r\n        pid: propTypes.any,\r\n        disabled: propTypes.bool,\r\n        collect: propTypes.func,\r\n        canDrop: propTypes.func,\r\n        hover: propTypes.func,\r\n        drop: propTypes.func\r\n    };\r\n\r\n    static defaultProps = {\r\n        pid: null\r\n    };\r\n\r\n    _connectDropTarget = null;\r\n\r\n    connectDrop() {\r\n        const { disabled } = this.props;\r\n\r\n        const dom = findDOMNode(this);\r\n        if (this._connectDropTarget) {\r\n            this._connectDropTarget(disabled ? null : dom);\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.connectDrop();\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        this.connectDrop();\r\n    }\r\n\r\n    render() {\r\n        const {\r\n            pid = null,\r\n            canDrop,\r\n            hover,\r\n            drop,\r\n            collect,\r\n            children\r\n        } = this.props;\r\n\r\n        const designer = React.useContext(ModelContext);\r\n        const DropContainerContext = designer.DropContainerContext;\r\n        const { isRootContainer } = React.useContext(DropContainerContext);\r\n\r\n        invariant(\r\n            isRootContainer ? true : pid != null,\r\n            \"sub DropContainer props.pid miss.\"\r\n        );\r\n\r\n        const [collectedProps, connectDropTarget] = useDrop({\r\n            accept: designer.getScope(),\r\n\r\n            canDrop({ item }, monitor) {\r\n                if (canDrop) {\r\n                    return canDrop(item, monitor);\r\n                }\r\n\r\n                return true;\r\n            },\r\n\r\n            hover({ item }, monitor) {\r\n                if (hover) {\r\n                    hover(item, monitor);\r\n                }\r\n\r\n                designer.fireEvent(\"onDragHoverContainer\", {\r\n                    target: pid,\r\n                    monitor,\r\n                    item\r\n                });\r\n\r\n                const isOver = monitor.isOver({ shallow: true });\r\n                if (!isOver) return;\r\n\r\n                if (!monitor.canDrop()) {\r\n                    return;\r\n                }\r\n\r\n                designer.updateItemPid(item, pid);\r\n            },\r\n\r\n            drop({ item }, monitor) {\r\n                if (drop) {\r\n                    drop(item, monitor);\r\n                }\r\n\r\n                //根节点统一commit\r\n                if (isRootContainer) {\r\n                    const isTmpItem = designer.isTmpItem(item);\r\n\r\n                    designer.fireEvent(\"onDrop\", {\r\n                        item,\r\n                        target: pid,\r\n                        action: isTmpItem ? ACTION_ADD : ACTION_SORT\r\n                    });\r\n\r\n                    designer.commitItem(item);\r\n                }\r\n            },\r\n\r\n            collect: monitor => {\r\n                const ext = collect ? collect(monitor) : {};\r\n\r\n                return {\r\n                    monitor,\r\n                    canDrop: monitor.canDrop(),\r\n                    isOver: monitor.isOver(),\r\n                    isStrictlyOver: monitor.isOver({ shallow: true }),\r\n                    ...ext\r\n                };\r\n            }\r\n        });\r\n\r\n        let items = designer.getItems(pid);\r\n        if (!collectedProps.isOver) {\r\n            items = items.filter(item => !designer.isTmpItem(item));\r\n        }\r\n\r\n        this._connectDropTarget = connectDropTarget;\r\n\r\n        const child =\r\n            typeof children === \"function\"\r\n                ? children(items, collectedProps)\r\n                : children;\r\n\r\n        React.Children.only(child);\r\n\r\n        return (\r\n            <DropContainerContext.Provider\r\n                value={{\r\n                    isRootContainer: false,\r\n                    canDrop: canDrop\r\n                }}>\r\n                {child}\r\n            </DropContainerContext.Provider>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withHooks(DropContainer);\r\n","import React from \"react\";\r\nimport { findDOMNode } from \"react-dom\";\r\nimport propTypes from \"prop-types\";\r\nimport withHooks from \"with-component-hooks\";\r\nimport { useDrop, useDrag } from \"react-dnd\";\r\nimport { ACTION_ADD, ACTION_SORT } from \"../constants\";\r\nimport ModelContext from \"../ModelContext\";\r\nimport { isBeforeRect } from \"../utils\";\r\n\r\nclass DropItem extends React.Component {\r\n    static propTypes = {\r\n        children: propTypes.func.isRequired,\r\n        item: propTypes.object.isRequired,\r\n        align: propTypes.oneOf([\"all\", \"vertical\", \"horizontal\"]),\r\n        canDrag: propTypes.func,\r\n        beginDrag: propTypes.func,\r\n        endDrag: propTypes.func\r\n    };\r\n\r\n    getDropOptions() {\r\n        const self = this;\r\n        let { item, align } = this.props;\r\n        const designer = React.useContext(ModelContext);\r\n        const DropContainerContext = designer.DropContainerContext;\r\n        const { canDrop } = React.useContext(DropContainerContext);\r\n\r\n        align = align || designer.props.align;\r\n\r\n        return {\r\n            accept: designer.getScope(),\r\n            canDrop({ item: dragItem }, monitor) {\r\n                return designer.isTmpItem(item)\r\n                    ? false\r\n                    : !designer.isSameItem(item, dragItem);\r\n            },\r\n\r\n            hover({ item: dragItem }, monitor) {\r\n                designer.fireEvent(\"onDragHoverItem\", {\r\n                    target: item,\r\n                    monitor,\r\n                    item: dragItem\r\n                });\r\n\r\n                const isOver = monitor.isOver({ shallow: true });\r\n                if (!isOver) return;\r\n\r\n                const canDropRet = canDrop ? canDrop(dragItem, monitor) : true;\r\n\r\n                if (!monitor.canDrop() || !canDropRet) {\r\n                    return;\r\n                }\r\n\r\n                const dragOffset = monitor.getClientOffset();\r\n                const targetDOM = findDOMNode(self);\r\n\r\n                //顺序调整\r\n                const targetOffset = targetDOM.getBoundingClientRect();\r\n\r\n                const middleX = ~~(targetOffset.right - targetOffset.width / 2);\r\n\r\n                const middleY = ~~(\r\n                    targetOffset.bottom -\r\n                    targetOffset.height / 2\r\n                );\r\n\r\n                let shouldInsertBefore = false;\r\n\r\n                switch (align) {\r\n                    case \"vertical\":\r\n                        shouldInsertBefore = dragOffset.y <= middleY;\r\n                        break;\r\n                    case \"horizontal\":\r\n                        shouldInsertBefore = dragOffset.x <= middleX;\r\n                        break;\r\n                    case \"all\":\r\n                        shouldInsertBefore = isBeforeRect(\r\n                            targetOffset.left,\r\n                            targetOffset.top,\r\n                            targetOffset.width,\r\n                            targetOffset.height,\r\n                            dragOffset.x,\r\n                            dragOffset.y\r\n                        );\r\n                        break;\r\n                    default:\r\n                        //vertical default\r\n                        shouldInsertBefore = dragOffset.y <= middleY;\r\n                }\r\n\r\n                if (shouldInsertBefore) {\r\n                    designer.insertBefore(dragItem, item);\r\n                } else {\r\n                    designer.insertAfter(dragItem, item);\r\n                }\r\n            },\r\n\r\n            collect(monitor) {\r\n                return {\r\n                    monitor,\r\n                    isOver: monitor.isOver(),\r\n                    isStrictlyOver: monitor.isOver({ shallow: true }),\r\n                    canDrop: designer.isTmpItem(item)\r\n                        ? false\r\n                        : monitor.canDrop()\r\n                };\r\n            }\r\n        };\r\n    }\r\n\r\n    getDragOptions() {\r\n        const { item, canDrag, beginDrag, endDrag } = this.props;\r\n        const designer = React.useContext(ModelContext);\r\n\r\n        return {\r\n            item: {\r\n                type: designer.getScope()\r\n            },\r\n\r\n            canDrag(monitor) {\r\n                if (canDrag) {\r\n                    return canDrag(monitor);\r\n                }\r\n                return true;\r\n            },\r\n\r\n            begin(monitor) {\r\n                if (beginDrag) {\r\n                    beginDrag(item, monitor);\r\n                }\r\n\r\n                designer.fireEvent(\"onDragStart\", {\r\n                    item,\r\n                    action: ACTION_SORT\r\n                });\r\n\r\n                designer.setItemDragging(item);\r\n\r\n                return {\r\n                    item\r\n                };\r\n            },\r\n\r\n            end(item, monitor) {\r\n                if (endDrag) {\r\n                    endDrag(item, monitor);\r\n                }\r\n\r\n                designer.fireEvent(\"onDragEnd\", {\r\n                    item,\r\n                    action: ACTION_SORT\r\n                });\r\n\r\n                //clearDraggingState\r\n                designer.clearTmpItems();\r\n            }\r\n\r\n            // collect(monitor) {\r\n            //     return {\r\n            //         // monitor,\r\n            //         // isDragging: monitor.isDragging()\r\n            //     };\r\n            // }\r\n        };\r\n    }\r\n\r\n    render() {\r\n        const { children, item } = this.props;\r\n        const designer = React.useContext(ModelContext);\r\n\r\n        const [collectedDropProps, connectDropTarget] = useDrop(\r\n            this.getDropOptions()\r\n        );\r\n\r\n        const [\r\n            collectedDragProps,\r\n            connectDragTarget,\r\n            connectDragPreview\r\n        ] = useDrag(this.getDragOptions());\r\n\r\n        const connectDragAndDrop = dom => {\r\n            connectDropTarget(dom);\r\n            connectDragTarget(dom);\r\n        };\r\n\r\n        return children({\r\n            ...collectedDropProps,\r\n            ...collectedDragProps,\r\n            item,\r\n            isTmp: designer.isTmpItem(item),\r\n            isDragging: designer.isDragging(item),\r\n            connectDropTarget,\r\n            connectDragTarget,\r\n            connectDragAndDrop,\r\n            connectDragPreview\r\n        });\r\n    }\r\n}\r\n\r\nexport default withHooks(DropItem);\r\n","/**\r\n * 判断指定坐标在指定矩形上的位置\r\n *\r\n * @param {number} x 矩形x坐标\r\n * @param {number} y 矩形y坐标\r\n * @param {number} width 矩形宽度\r\n * @param {number} height 矩形高度\r\n * @param {number} px 待检测坐标x(一般位鼠标x坐标)\r\n * @param {number} py 待检测坐标y(一般位鼠标y坐标)\r\n * @returns {number} 1:上 2:下 3:左 4:右 -1:对角线上(中心点)\r\n */\r\nexport function getRectDirection(x, y, width, height, px, py) {\r\n    const y_ac =\r\n        ((y + height) * px - y * px + y * (x + width) - (y + height) * x) /\r\n        (x + width - x);\r\n    const y_bd =\r\n        (y * px - (y + height) * px + (y + height) * (x + width) - y * x) /\r\n        (x + width - x);\r\n\r\n    if (py < y_ac && py < y_bd) {\r\n        return 1;\r\n    } else if (py > y_ac && py > y_bd) {\r\n        return 2;\r\n    } else if (py > y_ac && py < y_bd) {\r\n        return 3;\r\n    } else if (py < y_ac && py > y_bd) {\r\n        return 4;\r\n    } else {\r\n        //处在对角线上\r\n        const middle_x = x + width / 2;\r\n        const middle_y = y + height / 2;\r\n\r\n        if (px > middle_x && py < middle_y) {\r\n            //右上对角线\r\n            return 1;\r\n        } else if (px > middle_x && py > middle_y) {\r\n            //右下对角线\r\n            return 2;\r\n        } else if (px < middle_x && py < middle_y) {\r\n            //左上对角线\r\n            return 1;\r\n        } else if (px < middle_x && py > middle_y) {\r\n            //左下对角线\r\n            return 2;\r\n        } else {\r\n            //中心点\r\n            return -1;\r\n        }\r\n    }\r\n}\r\n\r\nexport function isBeforeRect(...a) {\r\n    const ret = getRectDirection(...a);\r\n\r\n    return ret === 1 || ret === 3;\r\n}\r\n","import React from \"react\";\r\nimport propTypes from \"prop-types\";\r\nimport { findDOMNode } from \"react-dom\";\r\nimport { useDrag } from \"react-dnd\";\r\nimport { getEmptyImage } from \"react-dnd-html5-backend\";\r\nimport withHooks from \"with-component-hooks\";\r\nimport ModelContext from \"../ModelContext\";\r\nimport { ACTION_ADD, ACTION_SORT } from \"../constants\";\r\n\r\nclass WidgetItem extends React.Component {\r\n    static propTypes = {\r\n        children: propTypes.func.isRequired,\r\n        getInstance: propTypes.func.isRequired,\r\n        canDrag: propTypes.func,\r\n        beginDrag: propTypes.func,\r\n        endDrag: propTypes.func\r\n    };\r\n\r\n    render() {\r\n        const {\r\n            children,\r\n            getInstance,\r\n            canDrag,\r\n            beginDrag,\r\n            endDrag\r\n        } = this.props;\r\n\r\n        const designer = React.useContext(ModelContext);\r\n\r\n        const [collectProps, connectDragTarget, connectDragPreview] = useDrag({\r\n            item: {\r\n                type: designer.getScope()\r\n            },\r\n\r\n            canDrag(monitor) {\r\n                if (canDrag) {\r\n                    return canDrag(monitor);\r\n                }\r\n                return true;\r\n            },\r\n\r\n            begin(monitor) {\r\n                const item = getInstance();\r\n\r\n                if (beginDrag) {\r\n                    beginDrag(item, monitor);\r\n                }\r\n\r\n                designer.fireEvent(\"onDragStart\", {\r\n                    item,\r\n                    action: ACTION_ADD\r\n                });\r\n\r\n                designer.addTmpItem(item);\r\n\r\n                return {\r\n                    item: item\r\n                };\r\n            },\r\n\r\n            end(item, monitor) {\r\n                if (endDrag) {\r\n                    endDrag(item, monitor);\r\n                }\r\n\r\n                designer.fireEvent(\"onDragEnd\", {\r\n                    item,\r\n                    action: ACTION_ADD\r\n                });\r\n\r\n                designer.clearTmpItems();\r\n            },\r\n\r\n            collect(monitor) {\r\n                return {\r\n                    monitor,\r\n                    isDragging: monitor.isDragging()\r\n                };\r\n            }\r\n        });\r\n\r\n        return children({\r\n            ...collectProps,\r\n            connectDragTarget,\r\n            connectDragPreview\r\n        });\r\n    }\r\n}\r\n\r\nexport default withHooks(WidgetItem);\r\n","import React from \"react\";\r\nimport { useDragLayer } from \"react-dnd\";\r\n\r\nexport default ({ children }) => {\r\n    const props = useDragLayer(monitor => {\r\n        return [\r\n            {\r\n                type: monitor.getItemType(),\r\n                item: monitor.getItem(),\r\n                isDragging: monitor.isDragging(),\r\n                initialClientOffset: monitor.getInitialClientOffset(),\r\n                initialSourceClientOffset: monitor.getInitialSourceClientOffset(),\r\n                clientOffset: monitor.getClientOffset(),\r\n                differenceFromInitialOffset: monitor.getDifferenceFromInitialOffset(),\r\n                sourceClientOffset: monitor.getSourceClientOffset()\r\n            },\r\n            monitor\r\n        ];\r\n    });\r\n\r\n    const child =\r\n        typeof children === \"function\"\r\n            ? children(props[0], props[1])\r\n            : children;\r\n\r\n    return child;\r\n};\r\n","import React from \"react\";\r\nimport { DropContainer, DropItem } from \"../src\";\r\n\r\nexport default function DropContainerDemo({ pid = null, title, canDrop }) {\r\n    return (\r\n        <DropContainer pid={pid} canDrop={canDrop}>\r\n            {(items, { monitor, canDrop }) => {\r\n                return (\r\n                    <div\r\n                        style={{\r\n                            border: canDrop\r\n                                ? \"1px solid green\"\r\n                                : \"1px solid #ccc\",\r\n                            flex: 1\r\n                        }}>\r\n                        <h3>{title}</h3>\r\n                        <hr />\r\n                        {items.map(item => {\r\n                            return (\r\n                                <DropItem key={item.id} item={item}>\r\n                                    {({\r\n                                        connectDragAndDrop,\r\n                                        isDragging,\r\n                                        isHover,\r\n                                        isOver,\r\n                                        isTmp\r\n                                    }) => {\r\n                                        return (\r\n                                            <div\r\n                                                ref={connectDragAndDrop}\r\n                                                style={{\r\n                                                    opacity: isDragging\r\n                                                        ? 0.5\r\n                                                        : 1,\r\n                                                    padding: 10,\r\n                                                    margin: 5,\r\n                                                    background: \"#f2f2f2\",\r\n                                                    border: \"1px solid #dadada\"\r\n                                                }}>\r\n                                                {item.title}({item.id})\r\n                                            </div>\r\n                                        );\r\n                                    }}\r\n                                </DropItem>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                );\r\n            }}\r\n        </DropContainer>\r\n    );\r\n}\r\n","import React from \"react\";\r\nimport { DropContainer, DropItem } from \"../src\";\r\nexport default function DropContainerWithChildDemo({ title, canDrop }) {\r\n    return (\r\n        <DropContainer pid=\"parent\" canDrop={canDrop}>\r\n            {(items, { monitor, canDrop }) => {\r\n                return (\r\n                    <div\r\n                        style={{\r\n                            border: canDrop\r\n                                ? \"1px solid green\"\r\n                                : \"1px solid #ccc\",\r\n                            flex: 1\r\n                        }}>\r\n                        <h3>{title}</h3>\r\n                        <hr />\r\n                        {items.map(item => {\r\n                            return (\r\n                                <DropItem key={item.id} item={item}>\r\n                                    {({\r\n                                        connectDragAndDrop,\r\n                                        isDragging,\r\n                                        isHover,\r\n                                        isOver,\r\n                                        isTmp\r\n                                    }) => {\r\n                                        return (\r\n                                            <div\r\n                                                ref={connectDragAndDrop}\r\n                                                style={{\r\n                                                    opacity: isDragging\r\n                                                        ? 0.5\r\n                                                        : 1,\r\n                                                    padding: 10,\r\n                                                    margin: 5,\r\n                                                    background: \"#f2f2f2\",\r\n                                                    border: \"1px solid #dadada\"\r\n                                                }}>\r\n                                                {item.title}({item.id})\r\n                                            </div>\r\n                                        );\r\n                                    }}\r\n                                </DropItem>\r\n                            );\r\n                        })}\r\n\r\n                        <DropContainer pid=\"child\">\r\n                            {(items, { monitor, canDrop }) => {\r\n                                return (\r\n                                    <div\r\n                                        style={{\r\n                                            height: 300,\r\n                                            overflow: \"auto\",\r\n                                            border: canDrop\r\n                                                ? \"1px solid green\"\r\n                                                : \"1px solid #ccc\",\r\n                                            flex: 1\r\n                                        }}>\r\n                                        <h3>child</h3>\r\n                                        <hr />\r\n                                        {items.map(item => {\r\n                                            return (\r\n                                                <DropItem\r\n                                                    key={item.id}\r\n                                                    item={item}>\r\n                                                    {({\r\n                                                        connectDragAndDrop,\r\n                                                        isDragging,\r\n                                                        isHover,\r\n                                                        isOver,\r\n                                                        isTmp\r\n                                                    }) => {\r\n                                                        return (\r\n                                                            <div\r\n                                                                ref={\r\n                                                                    connectDragAndDrop\r\n                                                                }\r\n                                                                style={{\r\n                                                                    opacity: isDragging\r\n                                                                        ? 0.5\r\n                                                                        : 1,\r\n                                                                    padding: 10,\r\n                                                                    margin: 5,\r\n                                                                    background:\r\n                                                                        \"#f2f2f2\",\r\n                                                                    border:\r\n                                                                        \"1px solid #dadada\"\r\n                                                                }}>\r\n                                                                {item.title}(\r\n                                                                {item.id})\r\n                                                            </div>\r\n                                                        );\r\n                                                    }}\r\n                                                </DropItem>\r\n                                            );\r\n                                        })}\r\n                                    </div>\r\n                                );\r\n                            }}\r\n                        </DropContainer>\r\n                    </div>\r\n                );\r\n            }}\r\n        </DropContainer>\r\n    );\r\n}\r\n","import TextField from \"./TextField\";\r\nimport TextareaField from \"./TextareaField\";\r\nimport SelectField from \"./SelectField\";\r\nimport CheckboxField from \"./CheckboxField\";\r\nimport RadioField from \"./RadioField\";\r\n\r\nexport default [\r\n    TextField,\r\n    TextareaField,\r\n    SelectField,\r\n    CheckboxField,\r\n    RadioField\r\n];\r\n","export default {\r\n    xtype: \"EX_TEXT_FIELD\",\r\n    title: \"文本\"\r\n};\r\n","export default {\r\n    xtype: \"EX_TEXTAREA_FIELD\",\r\n    title: \"多行文本\"\r\n};\r\n","export default {\r\n    xtype: \"EX_SELECT_FIELD\",\r\n    title: \"单选列表\"\r\n};\r\n","export default {\r\n    xtype: \"EX_CHECKBOX_FIELD\",\r\n    title: \"复选框\"\r\n};\r\n","export default {\r\n    xtype: \"EX_RADIO_FIELD\",\r\n    title: \"单选框\"\r\n};\r\n","import React from 'react';\r\n\r\nexport default React.createContext({});","import { getEmptyImage } from \"react-dnd-html5-backend\";\r\nimport WebDesignDndProvider from \"./WebDesignDndProvider\";\r\nimport { DropContainer, DropItem } from \"./DropContainer\";\r\nimport WidgetItem from \"./WidgetItem\";\r\nimport DragLayer from \"./DragLayer\";\r\nimport ModelContext from \"./ModelContext\";\r\n\r\nconst WebDesignContext = ModelContext;\r\n\r\nexport {\r\n    WebDesignContext,\r\n    WebDesignDndProvider,\r\n    WidgetItem,\r\n    DropContainer,\r\n    DropItem,\r\n    DragLayer,\r\n    getEmptyImage\r\n};\r\n","const ACTION_ADD = \"ADD\";\r\nconst ACTION_SORT = \"SORT\";\r\n\r\nexport { ACTION_ADD, ACTION_SORT };\r\n"],"sourceRoot":""}