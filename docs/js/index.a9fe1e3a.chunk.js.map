{"version":3,"sources":["webpack:///./src/index.js","webpack:///./src/utils/index.js","webpack:///./demo/index.js","webpack:///./demo/src/index.js","webpack:///./demo/src/basic/index.js","webpack:///./demo/src/basic/AnimateContainer.js","webpack:///./src/Provider.js","webpack:///./src/Model/index.js","webpack:///./src/ModelContext.js","webpack:///./src/DropContainer/index.js","webpack:///./src/DropItem/index.js","webpack:///./src/WidgetItem/index.js","webpack:///./src/DragLayer/index.js","webpack:///./src/hooks/index.js","webpack:///./src/DropEmptyContainer.js","webpack:///./demo/src/basic/DropContainerDemo.js","webpack:///./demo/src/basic/DropContainerWithChildDemo.js","webpack:///./demo/src/basic/widgets/index.js","webpack:///./demo/src/basic/widgets/TextField/index.js","webpack:///./demo/src/basic/widgets/TextareaField/index.js","webpack:///./demo/src/basic/widgets/SelectField/index.js","webpack:///./demo/src/basic/widgets/CheckboxField/index.js","webpack:///./demo/src/basic/widgets/RadioField/index.js","webpack:///./demo/src/sort-list/index.js","webpack:///./demo/src/sort-list-animation/index.js","webpack:///./demo/src/drag-layer/index.js","webpack:///./demo/src/todo-list/index.js","webpack:///./demo/src/pivot-table-01/index.js","webpack:///./demo/src/pivot-table-01/fields.js","webpack:///./demo/src/pivot-table-01/ItemDragLayer.js","webpack:///./demo/src/pivot-table-02/index.js","webpack:///./demo/src/pivot-table-02/fields.js","webpack:///./demo/src/pivot-table-02/ItemDragLayer.js","webpack:///./src/constants.js","webpack:///./src/Model/DragState.js"],"names":["_reactDndHtml5Backend","__webpack_require__","_Provider","_interopRequireDefault","_DropContainer","_DropItem","_WidgetItem","_DragLayer","_hooks","_DropEmptyContainer","constants","_interopRequireWildcard","_ModelContext","useModel","ModelContext","Provider","WidgetItem","DropContainer","DropItem","DragLayer","getEmptyImage","DropEmptyContainer","getRectDirection","x","y","width","height","px","py","y_ac","y_bd","middle_x","middle_y","ret","apply","arguments","dir","node","document","body","contains","_react","_reactDom","_src","ReactDOM","render","default","createElement","getElementById","_reactRouterDom","_basic","_sortList","_sortListAnimation","_dragLayer","_todoList","_pivotTable","_pivotTable2","HashRouter","className","NavLink","to","Switch","Route","path","exact","Redirect","component","Basic","SortList","TodoList","SortListAnimation","PivotTable1","PivotTable2","_React$useState","React","useState","items","_React$useState2","_slicedToArray2","metadata","onMetadataChange","value","onChange","onDragStart","ev","console","log","onDragEnd","onDrop","style","display","flex","widgets","map","widget","key","xtype","getInstance","_objectSpread2","id","Math","random","toString","slice","pid","index","idx","_ref2","connectDragTarget","ref","lineHeight","padding","title","_DropContainerDemo","_AnimateContainer","_DropContainerWithChildDemo","canDrop","item","DragLayerDemo","_widgets","_ref","isDragging","background","position","top","right","monitor","connectDropTarget","list","_toConsumableArray2","sort","a","b","border","pos","i","length","getPositionIndex","connectDragAndDrop","isOver","isHover","isTmp","transition","left","transform","concat","zIndex","opacity","_reactDnd","_Model","PageDesignCoreProvider","model","_this","this","_this$props","props","backend","_objectWithoutProperties2","DndProvider","_extends2","saveModel","Component","HTML5Backend","_propTypes","_find","_last","_findIndex","_DragState","_constants","randomStr","undefined","normalizeItem","idField","pidField","WebDesignModel","createContext","isRootContainer","axis","AXIS_VERTICAL","scope","defaultValue","DragState","getState","setState","state","eventName","handler","getAllItems","filter","_this$props2","pids","getItem","pNode","currentFieldId","push","getItemIndex","s1","s2","__tmp__","addItem","_this2","shouldRemove","getPids","indexOf","bItem","isSameItem","_this$props3","_idx","prevItem","oIdx","splice","_this$props4","nextItem","hasTmp","newItems","_this$props5","pidIndex","childs","getChildren","firstItem","lastItem","insertAfter","insertBefore","_this3","dragState","dragItem","hoverPid","hoverItem","hoverDirection","isNew","reset","moveItem","DRAG_DIR_UP","DRAG_DIR_LEFT","_addItem","getItems","updateItemPid","_create","children","getModel","forEach","propTypes","array","oneOf","AXIS_BOTH","AXIS_HORIZONTAL","commitAction","COMMIT_ACTION_AUTO","COMMIT_ACTION_DROP","func","onDragHoverContainer","onDragHoverItem","_withComponentHooks","_invariant","dom","findDOMNode","_connectDropTarget","_this$props$pid","hover","drop","collect","targetDOM","context","accept","getScope","dragResult","shallow","DRAG_DIR_NONE","fireEvent","target","didDrop","commitItem","commitDragStateItem","type","EVENT_TYPE_ADD","EVENT_TYPE_SORT","ext","isStrictlyOver","_this$props2$pid","DropContainerContext","useContext","_useDrop","useDrop","getDropOptions","_useDrop2","collectedProps","isTmpItem","child","oneOfType","any","_utils","targetOffset","getBoundingClientRect","dragOffset","getClientOffset","middleX","middleY","bottom","result","DRAG_DIR_DOWN","DRAG_DIR_RIGHT","getHoverDirection","pAxis","_model$props","mAxis","currentDirection","lastHoverDirection","_lastHoverDirection","forceUpdate","canDrag","beginDrag","endDrag","begin","dragDOM","_connectDragDOM","dragDOMIsRemove","end","_DragState$getState2","parentNode","removeChild","_connectDragTarget","setTimeout","isNodeInDocument","overflow","appendChild","_connectDragPreview","_this4","collectedDropProps","_useDrag","useDrag","getDragOptions","_useDrag2","collectedDragProps","connectDragPreview","useCallback","object","isRequired","addTmpItem","_DragState$getState","clearTmpItems","collectProps","useDragLayer","getItemType","initialClientOffset","getInitialClientOffset","initialSourceClientOffset","getInitialSourceClientOffset","clientOffset","differenceFromInitialOffset","getDifferenceFromInitialOffset","sourceClientOffset","getSourceClientOffset","_ref$pid","_ref3","margin","_ref4","_ref5","_TextField","_TextareaField","_SelectField","_CheckboxField","_RadioField","TextField","TextareaField","SelectField","CheckboxField","RadioField","dataset","ListItem","borderRadius","renderList","getItemPosition","ItemDragLayer","initData","useEffect","cloneNode","rect","pointerEvents","boxSizing","_React$useState3","_React$useState4","_ref6","memo","borderColor","borderTop","borderBottom","flexDirection","backgroundColor","_ref7","_classnames","_fields","_ItemDragLayer","fid","FieldItem","field","DropFieldContainer","_canDrop","names","name","field-drop-list","can-drop","is-over","onClick","removeItem","fields","_stringify","fontSize","cursor","E_VALUE_ITEM","handleChange","shouldShowEValue","EVI","currentDragDOM","newState"],"mappings":"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","file":"js/index.a9fe1e3a.chunk.js","sourcesContent":["import { getEmptyImage } from \"react-dnd-html5-backend\";\r\nimport Provider from \"./Provider\";\r\nimport DropContainer from \"./DropContainer\";\r\nimport DropItem from \"./DropItem\";\r\nimport WidgetItem from \"./WidgetItem\";\r\nimport DragLayer from \"./DragLayer\";\r\nimport { useModel } from \"./hooks\";\r\nimport DropEmptyContainer from \"./DropEmptyContainer\";\r\nimport * as constants from \"./constants\";\r\nimport ModelContext from \"./ModelContext\";\r\n\r\nexport {\r\n    useModel,\r\n    constants,\r\n    ModelContext,\r\n    Provider,\r\n    WidgetItem,\r\n    DropContainer,\r\n    DropItem,\r\n    DragLayer,\r\n    getEmptyImage,\r\n    DropEmptyContainer\r\n};\r\n\r\nexport default {\r\n    useModel,\r\n    constants,\r\n    ModelContext,\r\n    Provider,\r\n    WidgetItem,\r\n    DropContainer,\r\n    DropItem,\r\n    DragLayer,\r\n    getEmptyImage,\r\n    DropEmptyContainer\r\n};\r\n","/**\r\n * 判断指定坐标在指定矩形上的位置\r\n *\r\n * @param {number} x 矩形x坐标\r\n * @param {number} y 矩形y坐标\r\n * @param {number} width 矩形宽度\r\n * @param {number} height 矩形高度\r\n * @param {number} px 待检测坐标x(一般位鼠标x坐标)\r\n * @param {number} py 待检测坐标y(一般位鼠标y坐标)\r\n * @returns {number} 1:up 2:down 3:left 4:right -1:center(对角线上)\r\n */\r\nexport function getRectDirection(x, y, width, height, px, py) {\r\n    const y_ac =\r\n        ((y + height) * px - y * px + y * (x + width) - (y + height) * x) /\r\n        (x + width - x);\r\n    const y_bd =\r\n        (y * px - (y + height) * px + (y + height) * (x + width) - y * x) /\r\n        (x + width - x);\r\n\r\n    if (py < y_ac && py < y_bd) {\r\n        return 1;\r\n    } else if (py > y_ac && py > y_bd) {\r\n        return 2;\r\n    } else if (py > y_ac && py < y_bd) {\r\n        return 3;\r\n    } else if (py < y_ac && py > y_bd) {\r\n        return 4;\r\n    } else {\r\n        //处在对角线上\r\n        const middle_x = x + width / 2;\r\n        const middle_y = y + height / 2;\r\n\r\n        if (px > middle_x && py < middle_y) {\r\n            //右上对角线\r\n            return 1;\r\n        } else if (px > middle_x && py > middle_y) {\r\n            //右下对角线\r\n            return 2;\r\n        } else if (px < middle_x && py < middle_y) {\r\n            //左上对角线\r\n            return 1;\r\n        } else if (px < middle_x && py > middle_y) {\r\n            //左下对角线\r\n            return 2;\r\n        } else {\r\n            //中心点\r\n            return -1;\r\n        }\r\n    }\r\n}\r\n\r\nexport function isBeforeRect(...a) {\r\n    const ret = getRectDirection(...a);\r\n\r\n    return ret === 1 || ret === 3;\r\n}\r\n\r\nexport function getHoverDirection(...a) {\r\n    const ret = getRectDirection(...a);\r\n\r\n    let dir = \"down\";\r\n\r\n    if (ret === 1) {\r\n        dir = \"up\";\r\n    } else if (ret === 2) {\r\n        dir = \"down\";\r\n    } else if (ret === 3) {\r\n        dir = \"left\";\r\n    } else if (ret === 4) {\r\n        dir = \"right\";\r\n    }\r\n\r\n    return dir;\r\n}\r\n\r\nexport function isNodeInDocument(node) {\r\n    return document.body.contains(node);\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\nimport App from \"./src\";\r\n\r\nReactDOM.render(<App />, document.getElementById(\"root\"));\r\n","import React from \"react\";\r\n\r\nimport { HashRouter, Switch, Route, NavLink, Redirect } from \"react-router-dom\";\r\n\r\nimport Basic from \"./basic\";\r\nimport SortList from \"./sort-list\";\r\nimport SortListAnimation from \"./sort-list-animation\";\r\nimport DragLayer from \"./drag-layer\";\r\nimport TodoList from \"./todo-list\";\r\nimport PivotTable1 from \"./pivot-table-01\";\r\nimport PivotTable2 from \"./pivot-table-02\";\r\n\r\nimport \"./style/index.scss\";\r\n\r\nexport default () => {\r\n    return (\r\n        <HashRouter>\r\n            <div className=\"app-demo\">\r\n                <div className=\"left-nav\">\r\n                    <NavLink to=\"/basic\">基本功能</NavLink>\r\n                    <NavLink to=\"/sort-list\">列表排序</NavLink>\r\n                    <NavLink to=\"/sort-list-animation\">\r\n                        列表排序(动画效果)\r\n                    </NavLink>\r\n                    <NavLink to=\"/drag-layer\">自定义推拽层</NavLink>\r\n                    <NavLink to=\"/todo-list\">TodoList</NavLink>\r\n                    <NavLink to=\"/pivot-table-01\">多维分析</NavLink>\r\n                    <NavLink to=\"/pivot-table-02\">数据透视</NavLink>\r\n                </div>\r\n                <div className=\"container\">\r\n                    <Switch>\r\n                        <Route\r\n                            path=\"/\"\r\n                            exact\r\n                            render={() => <Redirect to=\"/basic\" />}\r\n                        />\r\n                        <Route path=\"/basic\" component={Basic} />\r\n                        <Route path=\"/sort-list\" component={SortList} />\r\n                        <Route path=\"/todo-list\" component={TodoList} />\r\n                        <Route\r\n                            path=\"/sort-list-animation\"\r\n                            component={SortListAnimation}\r\n                        />\r\n                        <Route path=\"/drag-layer\" component={DragLayer} />\r\n                        <Route path=\"/pivot-table-01\" component={PivotTable1} />\r\n                        <Route path=\"/pivot-table-02\" component={PivotTable2} />\r\n                    </Switch>\r\n                </div>\r\n            </div>\r\n        </HashRouter>\r\n    );\r\n};\r\n","import React from \"react\";\r\n\r\nimport AnimateContainer from \"./AnimateContainer\";\r\n\r\nimport DropContainerDemo from \"./DropContainerDemo\";\r\nimport DropContainerWithChildDemo from \"./DropContainerWithChildDemo\";\r\n\r\nimport { Provider, WidgetItem, DragLayer } from \"@/src\";\r\n\r\nimport widgets from \"./widgets\";\r\n\r\nfunction randomStr() {\r\n    return Math.random()\r\n        .toString(16)\r\n        .slice(2, 8);\r\n}\r\n\r\nlet idx = 1;\r\n\r\nfunction DragLayerDemo() {\r\n    return (\r\n        <DragLayer>\r\n            {({ isDragging }) =>\r\n                !isDragging ? null : (\r\n                    <div\r\n                        style={{\r\n                            padding: 5,\r\n                            background: \"rgba(0,0,0,.2)\",\r\n                            position: \"fixed\",\r\n                            top: 0,\r\n                            right: 0\r\n                        }}\r\n                    >\r\n                        dragLayer: isDragging...\r\n                    </div>\r\n                )\r\n            }\r\n        </DragLayer>\r\n    );\r\n}\r\n\r\nexport default function App() {\r\n    const [metadata, onMetadataChange] = React.useState({\r\n        items: []\r\n    });\r\n\r\n    function onChange(items) {\r\n        onMetadataChange({\r\n            items\r\n        });\r\n    }\r\n\r\n    return (\r\n        <Provider\r\n            // 受控\r\n            value={metadata.items}\r\n            onChange={onChange}\r\n            onDragStart={ev => {\r\n                console.log(\"onDragStart\", ev);\r\n            }}\r\n            onDragEnd={ev => {\r\n                console.log(\"onDragEnd\", ev);\r\n            }}\r\n            onDrop={ev => {\r\n                console.log(\"onDrop\", ev);\r\n            }}\r\n        >\r\n            <div\r\n                style={{\r\n                    display: \"flex\",\r\n                    height: \"100%\"\r\n                }}\r\n            >\r\n                <div\r\n                    style={{\r\n                        width: 240,\r\n                        flex: \"none\"\r\n                    }}\r\n                >\r\n                    {widgets.map(widget => {\r\n                        return (\r\n                            <WidgetItem\r\n                                key={widget.xtype}\r\n                                // disabled={widget.xtype === \"EX_URL_FIELD\"}\r\n                                getInstance={() => ({\r\n                                    ...widget,\r\n                                    id: randomStr(),\r\n                                    pid: null,\r\n                                    index: idx++\r\n                                })}\r\n                            >\r\n                                {({ connectDragTarget }) => (\r\n                                    <div\r\n                                        ref={connectDragTarget}\r\n                                        style={{\r\n                                            height: 32,\r\n                                            lineHeight: `32px`,\r\n                                            padding: \"0 20px\"\r\n                                        }}\r\n                                    >\r\n                                        {widget.title}\r\n                                    </div>\r\n                                )}\r\n                            </WidgetItem>\r\n                        );\r\n                    })}\r\n                </div>\r\n                <DropContainerDemo title=\"A\" />\r\n                <DropContainerDemo pid=\"b\" title=\"B\" />\r\n                <AnimateContainer />\r\n\r\n                <DropContainerWithChildDemo title=\"Parent\" />\r\n                <DropContainerDemo\r\n                    pid=\"d\"\r\n                    title=\"D\"\r\n                    canDrop={item => {\r\n                        return item.xtype === \"EX_TEXTAREA_FIELD\";\r\n                    }}\r\n                />\r\n                <DragLayerDemo />\r\n            </div>\r\n        </Provider>\r\n    );\r\n}\r\n","import React from \"react\";\r\nimport { DropContainer, DropItem } from \"@/src\";\r\n\r\nexport default function AnimateContainer() {\r\n    return (\r\n        <DropContainer pid=\"Animate\">\r\n            {({ items, monitor, canDrop, connectDropTarget }) => {\r\n                const list = [...items];\r\n                list.sort((a, b) => a.index - b.index);\r\n\r\n                function getPositionIndex(index) {\r\n                    for (let i = 0; i < items.length; i++) {\r\n                        const item = items[i];\r\n                        if (item.index === index) return i;\r\n                    }\r\n                }\r\n\r\n                return (\r\n                    <div\r\n                        ref={connectDropTarget}\r\n                        style={{\r\n                            position: \"relative\",\r\n                            border: canDrop\r\n                                ? \"1px solid green\"\r\n                                : \"1px solid #ccc\",\r\n                            flex: 1\r\n                        }}\r\n                    >\r\n                        <h3>Animate</h3>\r\n                        <hr />\r\n                        <div\r\n                            style={{\r\n                                position: \"relative\"\r\n                            }}\r\n                        >\r\n                            <div\r\n                                style={{\r\n                                    position: \"relative\"\r\n                                }}\r\n                            >\r\n                                {list.map((item, index) => {\r\n                                    var pos = getPositionIndex(item.index);\r\n\r\n                                    return (\r\n                                        <DropItem key={item.id} item={item}>\r\n                                            {({\r\n                                                connectDragAndDrop,\r\n                                                isDragging,\r\n                                                isHover,\r\n                                                isOver,\r\n                                                isTmp\r\n                                            }) => {\r\n                                                return (\r\n                                                    <div\r\n                                                        ref={connectDragAndDrop}\r\n                                                        key={item.id}\r\n                                                        id={item.id}\r\n                                                        style={{\r\n                                                            transition:\r\n                                                                \"transform .2s cubic-bezier(0.2, 0, 0, 1)\",\r\n                                                            position:\r\n                                                                \"absolute\",\r\n                                                            left: 5,\r\n                                                            right: 5,\r\n                                                            transform: `translate(0, ${(30 +\r\n                                                                18) *\r\n                                                                pos}px)`,\r\n                                                            zIndex: isDragging\r\n                                                                ? 2\r\n                                                                : 1,\r\n                                                            opacity: isDragging\r\n                                                                ? 0.5\r\n                                                                : 1,\r\n                                                            padding: 10,\r\n                                                            background:\r\n                                                                \"#f2f2f2\",\r\n                                                            border:\r\n                                                                isOver &&\r\n                                                                !isDragging\r\n                                                                    ? \"1px solid green\"\r\n                                                                    : \"1px solid #dadada\"\r\n                                                        }}\r\n                                                    >\r\n                                                        {item.title}({item.id})\r\n                                                    </div>\r\n                                                );\r\n                                            }}\r\n                                        </DropItem>\r\n                                    );\r\n                                })}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                );\r\n            }}\r\n        </DropContainer>\r\n    );\r\n}\r\n","import React from \"react\";\r\nimport HTML5Backend from \"react-dnd-html5-backend\";\r\nimport { DndProvider } from \"react-dnd\";\r\n\r\nimport Model from \"./Model\";\r\n\r\nexport default class PageDesignCoreProvider extends React.Component {\r\n    static defaultProps = {\r\n        backend: HTML5Backend\r\n    };\r\n\r\n    model = null;\r\n\r\n    getModel() {\r\n        return this.model;\r\n    }\r\n\r\n    saveModel = model => {\r\n        this.model = model;\r\n    };\r\n\r\n    render() {\r\n        const { backend, ...props } = this.props;\r\n\r\n        return (\r\n            <DndProvider backend={backend}>\r\n                <Model {...props} ref={this.saveModel} />\r\n            </DndProvider>\r\n        );\r\n    }\r\n}\r\n","import React from \"react\";\r\nimport propTypes from \"prop-types\";\r\nimport find from \"lodash/find\";\r\nimport last from \"lodash/last\";\r\nimport findIndex from \"lodash/findIndex\";\r\nimport ModelContext from \"../ModelContext\";\r\nimport DragState from \"./DragState\";\r\nimport {\r\n    COMMIT_ACTION_AUTO,\r\n    COMMIT_ACTION_DROP,\r\n    DRAG_DIR_UP,\r\n    DRAG_DIR_LEFT,\r\n    AXIS_VERTICAL,\r\n    AXIS_HORIZONTAL,\r\n    AXIS_BOTH\r\n} from \"../constants\";\r\n\r\nfunction randomStr(prefix = \"\") {\r\n    return (\r\n        prefix +\r\n        Math.random()\r\n            .toString(16)\r\n            .slice(2, 8)\r\n    );\r\n}\r\n\r\nfunction normalizeItem(item, props) {\r\n    const idField = props.idField;\r\n    const pidField = props.pidField;\r\n\r\n    item[idField] =\r\n        item[idField] === undefined ? randomStr(`item_`) : item[idField];\r\n\r\n    item[pidField] = item[pidField] === undefined ? null : item[pidField];\r\n\r\n    return item;\r\n}\r\n\r\nexport default class WebDesignModel extends React.Component {\r\n    static propTypes = {\r\n        value: propTypes.array,\r\n        defaultValue: propTypes.array,\r\n        axis: propTypes.oneOf([AXIS_BOTH, AXIS_HORIZONTAL, AXIS_VERTICAL]),\r\n        commitAction: propTypes.oneOf([COMMIT_ACTION_AUTO, COMMIT_ACTION_DROP]),\r\n        onChange: propTypes.func,\r\n        onDragStart: propTypes.func,\r\n        onDragEnd: propTypes.func,\r\n        onDrop: propTypes.func,\r\n        onDragHoverContainer: propTypes.func,\r\n        onDragHoverItem: propTypes.func\r\n    };\r\n\r\n    static getDerivedStateFromProps(props, state) {\r\n        if (props.value) {\r\n            props.value.forEach(item => normalizeItem(item, props));\r\n        }\r\n        return {\r\n            items: \"value\" in props ? props.value : state.items\r\n        };\r\n    }\r\n\r\n    static defaultProps = {\r\n        idField: \"id\",\r\n        pidField: \"pid\",\r\n        axis: AXIS_VERTICAL,\r\n        commitAction: COMMIT_ACTION_AUTO,\r\n        onChange: null\r\n    };\r\n\r\n    DropContainerContext = React.createContext({\r\n        isRootContainer: true,\r\n        axis: AXIS_VERTICAL\r\n    });\r\n\r\n    state = {\r\n        scope: randomStr(\"scope_\"),\r\n        items: this.props.defaultValue || []\r\n    };\r\n\r\n    getDragState() {\r\n        return DragState.getState();\r\n    }\r\n\r\n    onChange(items) {\r\n        const props = this.props;\r\n        const { onChange } = props;\r\n\r\n        if (!(\"value\" in props)) {\r\n            this.setState({\r\n                items\r\n            });\r\n        }\r\n\r\n        if (onChange) {\r\n            onChange(items);\r\n        }\r\n    }\r\n\r\n    getScope() {\r\n        return this.state.scope;\r\n    }\r\n\r\n    fireEvent(eventName, ev) {\r\n        const { onDragStart, onDragEnd, onDrop } = this.props;\r\n\r\n        const events = {\r\n            onDragStart,\r\n            onDragEnd,\r\n            onDrop\r\n        };\r\n\r\n        const handler = events[eventName];\r\n\r\n        if (handler) {\r\n            handler(ev);\r\n        }\r\n    }\r\n\r\n    getItems(pid = null) {\r\n        const { pidField } = this.props;\r\n        const items = this.getAllItems();\r\n\r\n        return items.filter(item => item && item[pidField] == pid);\r\n    }\r\n\r\n    getChildren(id = null, items = this.state.items) {\r\n        const { pidField } = this.props;\r\n        return items.filter(item => item && item[pidField] == id);\r\n    }\r\n\r\n    getAllItems() {\r\n        return [...this.state.items];\r\n    }\r\n\r\n    //获取组件的所有父级ID\r\n    getPids(id) {\r\n        const { idField, pidField } = this.props;\r\n        const pids = [];\r\n        let node = this.getItem(id);\r\n\r\n        if (!node) return pids;\r\n\r\n        if (!node[pidField]) return pids;\r\n\r\n        let currentFieldId = node[pidField];\r\n        let pNode;\r\n        while ((pNode = this.getItem(currentFieldId))) {\r\n            pids.push(pNode[idField]);\r\n            currentFieldId = pNode[pidField];\r\n            if (!currentFieldId) break;\r\n        }\r\n\r\n        return pids;\r\n    }\r\n\r\n    updateItem(item) {\r\n        const { idField } = this.props;\r\n        const items = this.getAllItems();\r\n        const id = item[idField];\r\n        const idx = this.getItemIndex(id);\r\n\r\n        if (idx !== -1) {\r\n            items[idx] = item;\r\n        }\r\n\r\n        this.onChange(items);\r\n    }\r\n\r\n    isSameItem(s1, s2) {\r\n        const { idField } = this.props;\r\n\r\n        return s1 && s2 && s1[idField] === s2[idField];\r\n    }\r\n\r\n    _addItem(item, pid = null) {\r\n        const { pidField } = this.props;\r\n        item = normalizeItem(item, this.props);\r\n        item[pidField] = pid;\r\n\r\n        this.state.items.push(item);\r\n    }\r\n\r\n    addItem(item, pid = null) {\r\n        const { pidField } = this.props;\r\n        item = normalizeItem(item, this.props);\r\n\r\n        const items = this.getAllItems();\r\n\r\n        item[pidField] = pid;\r\n\r\n        items.push(item);\r\n\r\n        this.onChange(items);\r\n    }\r\n\r\n    addTmpItem(item, pid) {\r\n        item.__tmp__ = true;\r\n        this.addItem(item, pid);\r\n    }\r\n\r\n    removeItem(id) {\r\n        const { idField } = this.props;\r\n        const items = this.getAllItems();\r\n        //移除指定项目及子项目\r\n        const ret = items.filter(item => {\r\n            let shouldRemove = item[idField] === id;\r\n\r\n            if (!shouldRemove) {\r\n                const pids = this.getPids(item[idField]);\r\n                shouldRemove = pids.indexOf(id) > -1;\r\n            }\r\n\r\n            return !shouldRemove;\r\n        });\r\n\r\n        this.onChange(ret);\r\n    }\r\n\r\n    getItemIndex(id, items) {\r\n        const { idField } = this.props;\r\n        items = items || this.getAllItems();\r\n        return findIndex(items, item => item[idField] === id);\r\n    }\r\n\r\n    getItem(id) {\r\n        const { idField } = this.props;\r\n        const items = this.getAllItems();\r\n        return find(items, item => item && item[idField] === id);\r\n    }\r\n\r\n    insertBefore(item, bItem) {\r\n        if (this.isSameItem(item, bItem)) return;\r\n\r\n        const { idField, pidField } = this.props;\r\n        const items = this.getAllItems();\r\n        const id = bItem[idField];\r\n        // const bItem = this.getItem(id);\r\n\r\n        //判断是否需要移动\r\n        const _idx = this.getItemIndex(id);\r\n        if (_idx !== 0) {\r\n            const prevItem = items[_idx - 1];\r\n            if (\r\n                prevItem[idField] === item[idField] &&\r\n                prevItem[pidField] === bItem[pidField]\r\n            ) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        //判断当前item是否已经存在, 如果存在则先删除\r\n        const oIdx = this.getItemIndex(item[idField]);\r\n        if (oIdx > -1) {\r\n            items.splice(oIdx, 1);\r\n        }\r\n\r\n        item[pidField] = bItem[pidField];\r\n\r\n        //插入操作\r\n        const idx = this.getItemIndex(id, items);\r\n        items.splice(idx, 0, item);\r\n\r\n        this.onChange(items);\r\n    }\r\n\r\n    insertAfter(item, prevItem) {\r\n        if (this.isSameItem(item, prevItem)) return;\r\n\r\n        const { idField, pidField } = this.props;\r\n        const items = this.getAllItems();\r\n        const id = prevItem[idField];\r\n        // const prevItem = this.getItem(id);\r\n\r\n        //判断是否需要移动\r\n        const _idx = this.getItemIndex(id);\r\n        if (_idx !== items.length - 1) {\r\n            const nextItem = items[_idx + 1];\r\n            if (\r\n                nextItem[idField] === item[idField] &&\r\n                nextItem[pidField] === prevItem[pidField]\r\n            ) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        //判断当前item是否已经存在, 如果存在则先删除\r\n        const oIdx = this.getItemIndex(item[idField]);\r\n        if (oIdx > -1) {\r\n            items.splice(oIdx, 1);\r\n        }\r\n\r\n        item[pidField] = prevItem[pidField];\r\n\r\n        //插入操作 之前有删除操作, 要重新查找index\r\n        const idx = findIndex(items, item => item[idField] === id);\r\n        items.splice(idx, 1, items[idx], item);\r\n\r\n        this.onChange(items);\r\n    }\r\n\r\n    clearTmpItems() {\r\n        const items = this.getAllItems();\r\n        let hasTmp = false;\r\n\r\n        const newItems = items.filter(item => {\r\n            const isTmp = item.__tmp__;\r\n            isTmp && (hasTmp = true);\r\n            return !isTmp;\r\n        });\r\n\r\n        hasTmp && this.onChange(newItems);\r\n    }\r\n\r\n    updateItemPid(item, pid = null) {\r\n        const { idField, pidField } = this.props;\r\n        const id = item[idField];\r\n        const idx = this.getItemIndex(id);\r\n\r\n        if (item[pidField] === pid) return true;\r\n\r\n        /**\r\n         * 局部环路检测\r\n         * 如: {id: A, pid: null}  {id: B, pid: A}\r\n         * 这是如果updateItemPid(A, B) 结果为:\r\n         * {id: A, pid: B}  {id: B, pid: A}\r\n         *\r\n         */\r\n        const pids = pid == null ? [] : this.getPids(pid);\r\n        if (pids.length) {\r\n            if (pids.indexOf(id) !== -1) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // 同级节点转变为子节点时顺序处理\r\n        if (pid) {\r\n            const pidIndex = this.getItemIndex(pid);\r\n            const childs = this.getChildren(pid);\r\n\r\n            if (childs.length) {\r\n                const firstItem = childs[0];\r\n                const lastItem = childs[childs.length - 1];\r\n\r\n                if (idx > pidIndex) {\r\n                    this.insertAfter(item, lastItem);\r\n                } else {\r\n                    this.insertBefore(item, firstItem);\r\n                }\r\n                return true;\r\n            }\r\n        }\r\n\r\n        if (idx !== -1) {\r\n            item[pidField] = pid;\r\n        }\r\n\r\n        this.onChange(this.getAllItems());\r\n\r\n        return true;\r\n    }\r\n\r\n    commitItem(item) {\r\n        const { idField } = this.props;\r\n        const items = this.getAllItems();\r\n        const id = item[idField];\r\n        const idx = this.getItemIndex(id);\r\n\r\n        if (idx !== -1 && item.__tmp__) {\r\n            item.__tmp__ = false;\r\n            delete item.__tmp__;\r\n            items[idx] = item;\r\n\r\n            this.onChange(items);\r\n        }\r\n    }\r\n\r\n    //提交DragState中的数据\r\n    commitDragStateItem() {\r\n        const dragState = DragState.getState();\r\n        const canDrop = dragState.canDrop;\r\n        const dragItem = dragState.item;\r\n        const hoverPid = dragState.hoverPid;\r\n        const hoverItem = dragState.hoverItem;\r\n        const hoverDirection = dragState.hoverDirection;\r\n        const isDragging = dragState.isDragging;\r\n        const isNew = dragState.isNew;\r\n\r\n        if (!isDragging || !canDrop) return;\r\n\r\n        DragState.reset();\r\n\r\n        const moveItem = () => {\r\n            if (\r\n                hoverDirection === DRAG_DIR_UP ||\r\n                hoverDirection === DRAG_DIR_LEFT\r\n            ) {\r\n                this.insertBefore(dragItem, hoverItem);\r\n            } else {\r\n                this.insertAfter(dragItem, hoverItem);\r\n            }\r\n        };\r\n\r\n        if (isNew) {\r\n            if (hoverItem) {\r\n                //新增\r\n                this._addItem(dragItem, undefined, false);\r\n                //移动\r\n                moveItem();\r\n            } else {\r\n                //新增\r\n                this.addItem(dragItem, hoverPid);\r\n            }\r\n        } else {\r\n            if (hoverItem) {\r\n                moveItem();\r\n            } else {\r\n                const childs = this.getItems(hoverPid);\r\n                const isExist = find(childs, item =>\r\n                    this.isSameItem(item, dragItem)\r\n                );\r\n\r\n                if (!isExist) {\r\n                    if (childs.length) {\r\n                        this.insertAfter(dragItem, last(childs));\r\n                    } else {\r\n                        this.updateItemPid(dragItem, hoverPid);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    isTmpItem(item) {\r\n        return !!item.__tmp__;\r\n    }\r\n\r\n    getModel() {\r\n        return Object.create(this);\r\n        // return {\r\n        //     DropContainerContext: this.DropContainerContext,\r\n        //     isSameItem: this.isSameItem.bind(this),\r\n        //     getScope: this.getScope.bind(this),\r\n        //     fireEvent: this.fireEvent.bind(this),\r\n        //     addItem: this.addItem.bind(this),\r\n        //     addTmpItem: this.addTmpItem.bind(this),\r\n        //     getPids: this.getPids.bind(this),\r\n        //     updateItem: this.updateItem.bind(this),\r\n        //     getItems: this.getItems.bind(this),\r\n        //     getAllItems: this.getAllItems.bind(this),\r\n        //     removeItem: this.removeItem.bind(this),\r\n        //     getItemIndex: this.getItemIndex.bind(this),\r\n        //     getItem: this.getItem.bind(this),\r\n        //     insertBefore: this.insertBefore.bind(this),\r\n        //     insertAfter: this.insertAfter.bind(this),\r\n        //     clearTmpItems: this.clearTmpItems.bind(this),\r\n        //     commitItem: this.commitItem.bind(this),\r\n        //     isTmpItem: this.isTmpItem.bind(this),\r\n        //     updateItemPid: this.updateItemPid.bind(this),\r\n        //     setItemDragging: this.setItemDragging.bind(this),\r\n        //     isDragging: this.isDragging.bind(this)\r\n        // };\r\n    }\r\n\r\n    render() {\r\n        const { children } = this.props;\r\n\r\n        return (\r\n            <ModelContext.Provider value={this.getModel()}>\r\n                {children}\r\n            </ModelContext.Provider>\r\n        );\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nexport default React.createContext({});","import React from \"react\";\r\nimport { findDOMNode } from \"react-dom\";\r\nimport { useDrop } from \"react-dnd\";\r\nimport propTypes from \"prop-types\";\r\nimport withHooks from \"with-component-hooks\";\r\nimport invariant from \"invariant\";\r\nimport {\r\n    EVENT_TYPE_ADD,\r\n    EVENT_TYPE_SORT,\r\n    DRAG_DIR_NONE,\r\n    DRAG_DIR_UP,\r\n    DRAG_DIR_LEFT,\r\n    COMMIT_ACTION_DROP,\r\n    COMMIT_ACTION_AUTO,\r\n    AXIS_VERTICAL,\r\n    AXIS_HORIZONTAL,\r\n    AXIS_BOTH\r\n} from \"../constants\";\r\nimport ModelContext from \"../ModelContext\";\r\nimport DragState from \"../Model/DragState\";\r\n\r\nclass DropContainer extends React.Component {\r\n    static contextType = ModelContext;\r\n\r\n    static propTypes = {\r\n        children: propTypes.oneOfType([propTypes.func, propTypes.node]),\r\n        axis: propTypes.oneOf([AXIS_BOTH, AXIS_HORIZONTAL, AXIS_VERTICAL]),\r\n        render: propTypes.func,\r\n        pid: propTypes.any,\r\n        collect: propTypes.func,\r\n        canDrop: propTypes.func,\r\n        hover: propTypes.func,\r\n        drop: propTypes.func\r\n    };\r\n\r\n    static defaultProps = {\r\n        pid: null\r\n    };\r\n\r\n    _connectDropTarget = null;\r\n\r\n    connectDropTarget() {\r\n        const children = this.props.children;\r\n\r\n        if (!children || typeof children === \"function\") return;\r\n\r\n        const dom = findDOMNode(this);\r\n\r\n        this._connectDropTarget(dom);\r\n    }\r\n\r\n    componentDidMount() {\r\n        //TODO: 后续提示_connectDropTarget是否被未被调用 DropItem WidgetItem 同样提示\r\n        this.connectDropTarget();\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        //TODO: 后续提示_connectDropTarget是否被未被调用\r\n        this.connectDropTarget();\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this._connectDropTarget(null);\r\n    }\r\n\r\n    getDropOptions() {\r\n        const { pid = null, hover, canDrop, drop, collect } = this.props;\r\n        const targetDOM = findDOMNode(this);\r\n\r\n        const model = this.context;\r\n\r\n        // const DropContainerContext = model.DropContainerContext;\r\n        // const { isRootContainer } = React.useContext(DropContainerContext);\r\n        const commitAction = model.props.commitAction;\r\n\r\n        return {\r\n            accept: model.getScope(),\r\n\r\n            canDrop: (dragResult, monitor) => {\r\n                if (canDrop) {\r\n                    return canDrop({\r\n                        ...dragResult,\r\n                        component: this,\r\n                        monitor,\r\n                        model\r\n                    });\r\n                }\r\n\r\n                return true;\r\n            },\r\n\r\n            hover: (dragResult, monitor) => {\r\n                const canDrop = monitor.canDrop();\r\n                if (hover) {\r\n                    hover({\r\n                        ...dragResult,\r\n                        component: this,\r\n                        monitor,\r\n                        model\r\n                    });\r\n                }\r\n\r\n                const isStrictlyOver = monitor.isOver({ shallow: true });\r\n                if (!isStrictlyOver) return;\r\n\r\n                DragState.setState({\r\n                    canDrop: monitor.canDrop(),\r\n                    hoverPid: pid,\r\n                    hoverItem: undefined,\r\n                    hoverDirection: DRAG_DIR_NONE\r\n                });\r\n\r\n                if (canDrop) {\r\n                    if (commitAction === COMMIT_ACTION_AUTO) {\r\n                        model.updateItemPid(dragResult.item, pid);\r\n                    }\r\n                }\r\n\r\n                model.fireEvent(\"onDragHoverContainer\", {\r\n                    target: pid,\r\n                    targetDOM,\r\n                    monitor,\r\n                    component: this,\r\n                    model,\r\n                    ...dragResult\r\n                });\r\n            },\r\n\r\n            drop: (dragResult, monitor) => {\r\n                if (drop) {\r\n                    drop({\r\n                        ...dragResult,\r\n                        component: this,\r\n                        monitor,\r\n                        model\r\n                    });\r\n                }\r\n\r\n                // //在根节点统一commit时会出现问题，当根节点canDrop返回false时导致无法提交\r\n                // if (isRootContainer) {\r\n                //     const isTmpItem = model.isTmpItem(dragResult.item);\r\n\r\n                //     model.fireEvent(\"onDrop\", {\r\n                //         target: pid,\r\n                //         targetDOM,\r\n                //         type: isTmpItem ? EVENT_TYPE_ADD : EVENT_TYPE_SORT,\r\n                //         ...dragResult\r\n                //     });\r\n\r\n                //     if (commitAction === COMMIT_ACTION_AUTO) {\r\n                //         model.commitItem(dragResult.item);\r\n                //     } else if (commitAction === COMMIT_ACTION_DROP) {\r\n                //         model.commitDragStateItem();\r\n                //     }\r\n                // }\r\n\r\n                if (!monitor.didDrop()) {\r\n                    if (commitAction === COMMIT_ACTION_AUTO) {\r\n                        model.commitItem(dragResult.item);\r\n                    } else if (commitAction === COMMIT_ACTION_DROP) {\r\n                        model.commitDragStateItem();\r\n                    }\r\n\r\n                    const { isNew } = DragState.getState();\r\n                    // const isTmpItem = model.isTmpItem(dragResult.item);\r\n                    model.fireEvent(\"onDrop\", {\r\n                        target: pid,\r\n                        targetDOM,\r\n                        type: isNew ? EVENT_TYPE_ADD : EVENT_TYPE_SORT,\r\n                        monitor,\r\n                        component: this,\r\n                        model,\r\n                        ...dragResult\r\n                    });\r\n                }\r\n            },\r\n\r\n            collect: monitor => {\r\n                const ext = collect ? collect(monitor) : {};\r\n\r\n                return {\r\n                    monitor,\r\n                    canDrop: monitor.canDrop(),\r\n                    isOver: monitor.isOver(),\r\n                    isStrictlyOver: monitor.isOver({ shallow: true }),\r\n                    ...ext\r\n                };\r\n            }\r\n        };\r\n    }\r\n\r\n    render() {\r\n        const { pid = null, children, render, axis } = this.props;\r\n\r\n        const model = this.context;\r\n\r\n        const DropContainerContext = model.DropContainerContext;\r\n        const { isRootContainer } = React.useContext(DropContainerContext);\r\n\r\n        invariant(\r\n            isRootContainer ? true : pid != null,\r\n            \"sub DropContainer props.pid miss.\"\r\n        );\r\n\r\n        const [collectedProps, connectDropTarget] = useDrop(\r\n            this.getDropOptions()\r\n        );\r\n\r\n        let items = model.getItems(pid);\r\n        if (!collectedProps.isStrictlyOver) {\r\n            items = items.filter(item => !model.isTmpItem(item));\r\n        }\r\n\r\n        this._connectDropTarget = connectDropTarget;\r\n\r\n        const props = {\r\n            ...collectedProps,\r\n            model,\r\n            connectDropTarget,\r\n            items\r\n        };\r\n\r\n        const child = children\r\n            ? typeof children === \"function\"\r\n                ? children(props)\r\n                : children\r\n            : render\r\n            ? render(props)\r\n            : null;\r\n\r\n        return (\r\n            <DropContainerContext.Provider\r\n                value={{\r\n                    isRootContainer: false,\r\n                    axis\r\n                }}\r\n            >\r\n                {child}\r\n            </DropContainerContext.Provider>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withHooks(DropContainer);\r\n","import React from \"react\";\r\nimport { findDOMNode } from \"react-dom\";\r\nimport propTypes from \"prop-types\";\r\nimport withHooks from \"with-component-hooks\";\r\nimport { useDrop, useDrag } from \"react-dnd\";\r\nimport {\r\n    EVENT_TYPE_ADD,\r\n    EVENT_TYPE_SORT,\r\n    DRAG_DIR_UP,\r\n    DRAG_DIR_LEFT,\r\n    DRAG_DIR_RIGHT,\r\n    DRAG_DIR_DOWN,\r\n    DRAG_DIR_NONE,\r\n    COMMIT_ACTION_DROP,\r\n    COMMIT_ACTION_AUTO,\r\n    AXIS_VERTICAL,\r\n    AXIS_HORIZONTAL,\r\n    AXIS_BOTH\r\n} from \"../constants\";\r\nimport ModelContext from \"../ModelContext\";\r\nimport { isNodeInDocument, getHoverDirection } from \"../utils\";\r\n\r\nimport DragState from \"../Model/DragState\";\r\n\r\nclass DropItem extends React.Component {\r\n    static contextType = ModelContext;\r\n\r\n    static propTypes = {\r\n        children: propTypes.oneOfType([propTypes.func, propTypes.node]),\r\n        render: propTypes.func,\r\n        item: propTypes.object.isRequired,\r\n        axis: propTypes.oneOf([AXIS_BOTH, AXIS_HORIZONTAL, AXIS_VERTICAL]),\r\n        canDrop: propTypes.func,\r\n        hover: propTypes.func,\r\n        canDrag: propTypes.func,\r\n        beginDrag: propTypes.func,\r\n        endDrag: propTypes.func\r\n    };\r\n\r\n    _lastHoverDirection = DRAG_DIR_NONE;\r\n\r\n    getHoverDirection(\r\n        monitor,\r\n        targetDOM = findDOMNode(this),\r\n        axis = AXIS_VERTICAL\r\n    ) {\r\n        const targetOffset = targetDOM.getBoundingClientRect();\r\n\r\n        const dragOffset = monitor.getClientOffset();\r\n\r\n        const middleX = ~~(targetOffset.right - targetOffset.width / 2);\r\n        const middleY = ~~(targetOffset.bottom - targetOffset.height / 2);\r\n\r\n        let result = false;\r\n\r\n        switch (axis) {\r\n            case AXIS_VERTICAL:\r\n                result = dragOffset.y <= middleY ? DRAG_DIR_UP : DRAG_DIR_DOWN;\r\n                break;\r\n            case AXIS_HORIZONTAL:\r\n                result =\r\n                    dragOffset.x <= middleX ? DRAG_DIR_LEFT : DRAG_DIR_RIGHT;\r\n                break;\r\n            case AXIS_BOTH:\r\n                result = getHoverDirection(\r\n                    targetOffset.left,\r\n                    targetOffset.top,\r\n                    targetOffset.width,\r\n                    targetOffset.height,\r\n                    dragOffset.x,\r\n                    dragOffset.y\r\n                );\r\n                break;\r\n            default:\r\n                //vertical default\r\n                result = dragOffset.y <= middleY ? DRAG_DIR_UP : DRAG_DIR_DOWN;\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    getDropOptions() {\r\n        let { item, axis, canDrop, hover, drop } = this.props;\r\n        const targetDOM = findDOMNode(this);\r\n        const model = this.context;\r\n        const DropContainerContext = model.DropContainerContext;\r\n        const { axis: pAxis } = React.useContext(DropContainerContext);\r\n        const { commitAction, axis: mAxis } = model.props;\r\n\r\n        axis = axis || pAxis || mAxis;\r\n\r\n        return {\r\n            accept: model.getScope(),\r\n            canDrop: (dragResult, monitor) => {\r\n                const dragItem = dragResult.item;\r\n\r\n                let ret = model.isTmpItem(item)\r\n                    ? false\r\n                    : !model.isSameItem(item, dragItem);\r\n\r\n                if (ret && canDrop) {\r\n                    ret = canDrop({\r\n                        ...dragResult,\r\n                        component: this,\r\n                        monitor,\r\n                        model\r\n                    });\r\n                }\r\n\r\n                return ret;\r\n            },\r\n\r\n            hover: (dragResult, monitor) => {\r\n                const canDrop = monitor.canDrop();\r\n                if (hover) {\r\n                    hover({\r\n                        ...dragResult,\r\n                        component: this,\r\n                        monitor,\r\n                        model\r\n                    });\r\n                }\r\n\r\n                const isStrictlyOver = monitor.isOver({ shallow: true });\r\n                if (!isStrictlyOver) return;\r\n\r\n                const dragItem = dragResult.item;\r\n\r\n                const currentDirection = this.getHoverDirection(\r\n                    monitor,\r\n                    targetDOM,\r\n                    axis\r\n                );\r\n                const lastHoverDirection = this._lastHoverDirection;\r\n                this._lastHoverDirection = currentDirection;\r\n\r\n                DragState.setState({\r\n                    canDrop,\r\n                    hoverPid: undefined,\r\n                    hoverItem: item,\r\n                    hoverDirection: currentDirection\r\n                });\r\n\r\n                if (canDrop) {\r\n                    if (currentDirection !== lastHoverDirection) {\r\n                        //TODO: 此处最好再加参数控制。当commitAction=COMMIT_ACTION_AUTO且不需要hoverDirection属性时不建议执行\r\n                        //eg: && needHoverDirection\r\n                        this.forceUpdate();\r\n                    }\r\n\r\n                    if (commitAction === COMMIT_ACTION_AUTO) {\r\n                        if (\r\n                            currentDirection === DRAG_DIR_UP ||\r\n                            currentDirection === DRAG_DIR_LEFT\r\n                        ) {\r\n                            model.insertBefore(dragItem, item);\r\n                        } else {\r\n                            model.insertAfter(dragItem, item);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                model.fireEvent(\"onDragHoverItem\", {\r\n                    target: item,\r\n                    targetDOM,\r\n                    monitor,\r\n                    component: this,\r\n                    model,\r\n                    ...dragResult\r\n                });\r\n            },\r\n\r\n            drop: (dragResult, monitor) => {\r\n                if (drop) {\r\n                    drop({\r\n                        ...dragResult,\r\n                        component: this,\r\n                        monitor,\r\n                        model\r\n                    });\r\n                }\r\n\r\n                if (!monitor.didDrop()) {\r\n                    if (commitAction === COMMIT_ACTION_AUTO) {\r\n                        model.commitItem(dragResult.item);\r\n                    } else if (commitAction === COMMIT_ACTION_DROP) {\r\n                        model.commitDragStateItem();\r\n                    }\r\n\r\n                    const { isNew } = DragState.getState();\r\n                    // const isTmpItem = model.isTmpItem(dragResult.item);\r\n                    model.fireEvent(\"onDrop\", {\r\n                        target: item,\r\n                        targetDOM,\r\n                        type: isNew ? EVENT_TYPE_ADD : EVENT_TYPE_SORT,\r\n                        monitor,\r\n                        component: this,\r\n                        model,\r\n                        ...dragResult\r\n                    });\r\n                }\r\n            },\r\n\r\n            collect: monitor => {\r\n                return {\r\n                    monitor,\r\n                    hoverDirection: DRAG_DIR_NONE,\r\n                    isOver: monitor.isOver(),\r\n                    isStrictlyOver: monitor.isOver({ shallow: true }),\r\n                    canDrop: model.isTmpItem(item) ? false : monitor.canDrop()\r\n                };\r\n            }\r\n        };\r\n    }\r\n\r\n    getDragOptions() {\r\n        const { item, canDrag, beginDrag, endDrag } = this.props;\r\n        const model = this.context;\r\n\r\n        return {\r\n            item: {\r\n                type: model.getScope()\r\n            },\r\n\r\n            canDrag: monitor => {\r\n                if (canDrag) {\r\n                    return canDrag({\r\n                        component: this,\r\n                        monitor,\r\n                        model\r\n                    });\r\n                }\r\n                return true;\r\n            },\r\n\r\n            begin: monitor => {\r\n                const dom = findDOMNode(this);\r\n                const dragDOM = this._connectDragDOM;\r\n\r\n                if (beginDrag) {\r\n                    beginDrag({\r\n                        item,\r\n                        dom,\r\n                        component: this,\r\n                        monitor,\r\n                        model\r\n                    });\r\n                }\r\n\r\n                DragState.setState({\r\n                    item,\r\n                    isNew: false,\r\n                    dragDOMIsRemove: false,\r\n                    isDragging: true,\r\n                    dragDOM\r\n                });\r\n\r\n                model.fireEvent(\"onDragStart\", {\r\n                    item,\r\n                    dom,\r\n                    type: EVENT_TYPE_SORT,\r\n                    model,\r\n                    monitor,\r\n                    component: this\r\n                });\r\n\r\n                return {\r\n                    item,\r\n                    dom\r\n                };\r\n            },\r\n\r\n            end: (dragResult, monitor) => {\r\n                const { dragDOMIsRemove, dragDOM } = DragState.getState();\r\n                DragState.reset();\r\n                if (dragDOMIsRemove && dragDOM && dragDOM.parentNode) {\r\n                    dragDOM.parentNode.removeChild(dragDOM);\r\n                }\r\n\r\n                if (endDrag) {\r\n                    endDrag({\r\n                        ...dragResult,\r\n                        model,\r\n                        monitor,\r\n                        component: this\r\n                    });\r\n                }\r\n\r\n                model.fireEvent(\"onDragEnd\", {\r\n                    ...dragResult,\r\n                    type: EVENT_TYPE_SORT,\r\n                    model,\r\n                    monitor,\r\n                    component: this\r\n                });\r\n            },\r\n\r\n            collect(monitor) {\r\n                const dragResult = monitor.getItem();\r\n\r\n                return {\r\n                    // monitor\r\n                    isDragging:\r\n                        dragResult && model.isSameItem(dragResult.item, item)\r\n                };\r\n            }\r\n        };\r\n    }\r\n\r\n    _connectDragDOM = null;\r\n\r\n    _connectDropTarget = null;\r\n    _connectDragTarget = null;\r\n    _connectDragPreview = null;\r\n\r\n    componentDidUpdate() {\r\n        this.connectDragAndDrop();\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.connectDragAndDrop();\r\n    }\r\n\r\n    connectDragAndDrop() {\r\n        const children = this.props.children;\r\n\r\n        if (!children || typeof children === \"function\") return;\r\n\r\n        const dom = findDOMNode(this);\r\n\r\n        this._connectDropTarget(dom);\r\n        this._connectDragTarget(dom);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        //fix: 当拖动节点在拖动状态被删除时导致react-dnd在drop后需要移动鼠标才及时触发endDrag问题\r\n        const dragDOM = this._connectDragDOM;\r\n        const dragState = DragState.getState();\r\n        if (dragState.isDragging && dragDOM && dragState.dragDOM === dragDOM) {\r\n            DragState.setState({\r\n                dragDOMIsRemove: true\r\n            });\r\n\r\n            setTimeout(() => {\r\n                if (isNodeInDocument(dragDOM)) return;\r\n\r\n                dragDOM.style.display = \"none\";\r\n                dragDOM.style.width = \"0px\";\r\n                dragDOM.style.height = \"0px\";\r\n                dragDOM.style.overflow = \"hidden\";\r\n\r\n                document.body.appendChild(dragDOM);\r\n            }, 0);\r\n        }\r\n\r\n        this._connectDropTarget(null);\r\n        this._connectDragTarget(null);\r\n        this._connectDragPreview(null);\r\n    }\r\n\r\n    render() {\r\n        const { children, render, item } = this.props;\r\n        const model = this.context;\r\n\r\n        const [collectedDropProps, connectDropTarget] = useDrop(\r\n            this.getDropOptions()\r\n        );\r\n\r\n        const [\r\n            collectedDragProps,\r\n            connectDragTarget,\r\n            connectDragPreview\r\n        ] = useDrag(this.getDragOptions());\r\n\r\n        this._connectDropTarget = connectDropTarget;\r\n        this._connectDragTarget = React.useCallback(\r\n            dom => {\r\n                this._connectDragDOM = dom;\r\n                connectDragTarget(dom);\r\n            },\r\n            [connectDragTarget]\r\n        );\r\n        this._connectDragPreview = connectDragPreview;\r\n\r\n        const connectDragAndDrop = dom => {\r\n            this._connectDropTarget(dom);\r\n            this._connectDragTarget(dom);\r\n        };\r\n\r\n        const props = {\r\n            ...collectedDropProps,\r\n            ...collectedDragProps,\r\n            item,\r\n            isTmp: model.isTmpItem(item),\r\n            model,\r\n            connectDropTarget,\r\n            connectDragTarget,\r\n            connectDragAndDrop,\r\n            connectDragPreview\r\n        };\r\n\r\n        const { isStrictlyOver, isDragging, canDrop } = props;\r\n\r\n        props.hoverDirection =\r\n            isStrictlyOver && !isDragging && canDrop\r\n                ? this._lastHoverDirection\r\n                : DRAG_DIR_NONE;\r\n\r\n        return children\r\n            ? typeof children === \"function\"\r\n                ? children(props)\r\n                : children\r\n            : render\r\n            ? render(props)\r\n            : null;\r\n    }\r\n}\r\n\r\nexport default withHooks(DropItem);\r\n","import React from \"react\";\r\nimport { findDOMNode } from \"react-dom\";\r\nimport propTypes from \"prop-types\";\r\nimport { useDrag } from \"react-dnd\";\r\nimport withHooks from \"with-component-hooks\";\r\nimport ModelContext from \"../ModelContext\";\r\nimport {\r\n    EVENT_TYPE_ADD,\r\n    EVENT_TYPE_SORT,\r\n    COMMIT_ACTION_AUTO,\r\n    COMMIT_ACTION_DROP\r\n} from \"../constants\";\r\nimport { isNodeInDocument } from \"../utils\";\r\nimport DragState from \"../Model/DragState\";\r\n\r\nclass WidgetItem extends React.Component {\r\n    static contextType = ModelContext;\r\n\r\n    static propTypes = {\r\n        children: propTypes.oneOfType([propTypes.func, propTypes.node]),\r\n        render: propTypes.func,\r\n        getInstance: propTypes.func.isRequired,\r\n        canDrag: propTypes.func,\r\n        beginDrag: propTypes.func,\r\n        endDrag: propTypes.func\r\n    };\r\n\r\n    _connectDragDOM = null;\r\n\r\n    _connectDragTarget = null;\r\n    _connectDragPreview = null;\r\n\r\n    componentDidUpdate() {\r\n        this.connectDragTarget();\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.connectDragTarget();\r\n    }\r\n\r\n    connectDragTarget() {\r\n        const children = this.props.children;\r\n\r\n        if (!children || typeof children === \"function\") return;\r\n\r\n        this._connectDragTarget(findDOMNode(this));\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        //fix: 当拖动节点在拖动状态被删除时导致react-dnd在drop后需要移动鼠标才及时触发endDrag问题\r\n        const dragDOM = this._connectDragDOM;\r\n        const dragState = DragState.getState();\r\n        if (dragState.isDragging && dragDOM && dragState.dragDOM === dragDOM) {\r\n            DragState.setState({\r\n                dragDOMIsRemove: true\r\n            });\r\n\r\n            setTimeout(() => {\r\n                if (isNodeInDocument(dragDOM)) return;\r\n\r\n                dragDOM.style.display = \"none\";\r\n                dragDOM.style.width = \"0px\";\r\n                dragDOM.style.height = \"0px\";\r\n                dragDOM.style.overflow = \"hidden\";\r\n\r\n                document.body.appendChild(dragDOM);\r\n            }, 0);\r\n        }\r\n\r\n        this._connectDragTarget(null);\r\n        this._connectDragPreview(null);\r\n    }\r\n\r\n    getDragOptions() {\r\n        const { getInstance, canDrag, beginDrag, endDrag } = this.props;\r\n        const model = this.context;\r\n        const commitAction = model.props.commitAction;\r\n\r\n        return {\r\n            item: {\r\n                type: model.getScope()\r\n            },\r\n\r\n            canDrag: monitor => {\r\n                if (canDrag) {\r\n                    return canDrag({\r\n                        monitor,\r\n                        model,\r\n                        component: this\r\n                    });\r\n                }\r\n\r\n                return true;\r\n            },\r\n\r\n            begin: monitor => {\r\n                const item = getInstance();\r\n                const dom = findDOMNode(this);\r\n\r\n                if (beginDrag) {\r\n                    beginDrag({\r\n                        item,\r\n                        dom,\r\n                        component: this,\r\n                        monitor,\r\n                        model\r\n                    });\r\n                }\r\n\r\n                const dragDOM = this._connectDragDOM;\r\n                DragState.setState({\r\n                    item,\r\n                    isNew: true,\r\n                    dragDOMIsRemove: false,\r\n                    isDragging: true,\r\n                    dragDOM\r\n                });\r\n\r\n                if (commitAction === COMMIT_ACTION_AUTO) {\r\n                    model.addTmpItem(item);\r\n                }\r\n\r\n                model.fireEvent(\"onDragStart\", {\r\n                    item,\r\n                    dom,\r\n                    type: EVENT_TYPE_ADD,\r\n                    model,\r\n                    monitor,\r\n                    component: this\r\n                });\r\n\r\n                return {\r\n                    item,\r\n                    dom\r\n                };\r\n            },\r\n\r\n            end: (dragResult, monitor) => {\r\n                const { dragDOMIsRemove, dragDOM } = DragState.getState();\r\n                DragState.reset();\r\n\r\n                if (dragDOMIsRemove && dragDOM && dragDOM.parentNode) {\r\n                    dragDOM.parentNode.removeChild(dragDOM);\r\n                }\r\n\r\n                if (endDrag) {\r\n                    endDrag({\r\n                        ...dragResult,\r\n                        model,\r\n                        monitor,\r\n                        component: this\r\n                    });\r\n                }\r\n\r\n                model.clearTmpItems();\r\n\r\n                model.fireEvent(\"onDragEnd\", {\r\n                    ...dragResult,\r\n                    type: EVENT_TYPE_ADD,\r\n                    model,\r\n                    monitor,\r\n                    component: this\r\n                });\r\n            },\r\n\r\n            collect(monitor) {\r\n                return {\r\n                    monitor,\r\n                    isDragging: monitor.isDragging()\r\n                };\r\n            }\r\n        };\r\n    }\r\n\r\n    render() {\r\n        const { children, render } = this.props;\r\n        const model = this.context;\r\n\r\n        const [collectProps, connectDragTarget, connectDragPreview] = useDrag(\r\n            this.getDragOptions()\r\n        );\r\n\r\n        this._connectDragTarget = React.useCallback(\r\n            dom => {\r\n                this._connectDragDOM = dom;\r\n                connectDragTarget(dom);\r\n            },\r\n            [connectDragTarget]\r\n        );\r\n        this._connectDragPreview = connectDragPreview;\r\n\r\n        const props = {\r\n            ...collectProps,\r\n            model,\r\n            connectDragTarget,\r\n            connectDragPreview\r\n        };\r\n\r\n        return children\r\n            ? typeof children === \"function\"\r\n                ? children(props)\r\n                : children\r\n            : render\r\n            ? render(props)\r\n            : null;\r\n    }\r\n}\r\n\r\nexport default withHooks(WidgetItem);\r\n","import React from \"react\";\r\nimport { useDragLayer } from \"react-dnd\";\r\n\r\nexport default ({ children }) => {\r\n    const props = useDragLayer(monitor => {\r\n        const dragResult = monitor.getItem();\r\n        return {\r\n            ...dragResult,\r\n            monitor,\r\n            type: monitor.getItemType(),\r\n            isDragging: monitor.isDragging(),\r\n            initialClientOffset: monitor.getInitialClientOffset(),\r\n            initialSourceClientOffset: monitor.getInitialSourceClientOffset(),\r\n            clientOffset: monitor.getClientOffset(),\r\n            differenceFromInitialOffset: monitor.getDifferenceFromInitialOffset(),\r\n            sourceClientOffset: monitor.getSourceClientOffset()\r\n        };\r\n    });\r\n\r\n    const child = typeof children === \"function\" ? children(props) : children;\r\n\r\n    return child;\r\n};\r\n","import React from \"react\";\r\nimport ModelContext from \"../ModelContext\";\r\n\r\nexport function useModel() {\r\n    return React.useContext(ModelContext);\r\n}\r\n","import React from \"react\";\r\nimport { findDOMNode } from \"react-dom\";\r\nimport { useDrop } from \"react-dnd\";\r\nimport withHooks from \"with-component-hooks\";\r\nimport ModelContext from \"./ModelContext\";\r\n\r\nclass DropEmptyContainer extends React.Component {\r\n    static contextType = ModelContext;\r\n\r\n    _connectDropTarget = null;\r\n\r\n    connectDropTarget() {\r\n        const dom = findDOMNode(this);\r\n        this._connectDropTarget(dom);\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.connectDropTarget();\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        this.connectDropTarget();\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this._connectDropTarget(null);\r\n    }\r\n\r\n    getDropOptions() {\r\n        const model = this.context;\r\n\r\n        return {\r\n            accept: model.getScope()\r\n        };\r\n    }\r\n\r\n    render() {\r\n        const [collectedProps, connectDropTarget] = useDrop(\r\n            this.getDropOptions()\r\n        );\r\n\r\n        this._connectDropTarget = connectDropTarget;\r\n\r\n        return this.props.children;\r\n    }\r\n}\r\n\r\nexport default withHooks(DropEmptyContainer);\r\n","import React from \"react\";\r\nimport { DropContainer, DropItem } from \"@/src\";\r\n\r\nexport default function DropContainerDemo({ pid = null, title, canDrop }) {\r\n    return (\r\n        <DropContainer pid={pid} canDrop={canDrop}>\r\n            {({ items, monitor, canDrop, connectDropTarget }) => {\r\n                return (\r\n                    <div\r\n                        ref={connectDropTarget}\r\n                        style={{\r\n                            border: canDrop\r\n                                ? \"1px solid green\"\r\n                                : \"1px solid #ccc\",\r\n                            flex: 1\r\n                        }}\r\n                    >\r\n                        <h3>{title}</h3>\r\n                        <hr />\r\n                        {items.map(item => {\r\n                            return (\r\n                                <DropItem key={item.id} item={item}>\r\n                                    {({\r\n                                        connectDragAndDrop,\r\n                                        isDragging,\r\n                                        isHover,\r\n                                        isOver,\r\n                                        isTmp\r\n                                    }) => {\r\n                                        return (\r\n                                            <div\r\n                                                ref={connectDragAndDrop}\r\n                                                style={{\r\n                                                    opacity: isDragging\r\n                                                        ? 0.5\r\n                                                        : 1,\r\n                                                    padding: 10,\r\n                                                    margin: 5,\r\n                                                    background: \"#f2f2f2\",\r\n                                                    border: \"1px solid #dadada\"\r\n                                                }}\r\n                                            >\r\n                                                {item.title}({item.id})\r\n                                            </div>\r\n                                        );\r\n                                    }}\r\n                                </DropItem>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                );\r\n            }}\r\n        </DropContainer>\r\n    );\r\n}\r\n","import React from \"react\";\r\nimport { DropContainer, DropItem } from \"@/src\";\r\nexport default function DropContainerWithChildDemo({ title, canDrop }) {\r\n    return (\r\n        <DropContainer pid=\"parent\" canDrop={canDrop}>\r\n            {({ items, monitor, canDrop, connectDropTarget }) => {\r\n                return (\r\n                    <div\r\n                        ref={connectDropTarget}\r\n                        style={{\r\n                            border: canDrop\r\n                                ? \"1px solid green\"\r\n                                : \"1px solid #ccc\",\r\n                            flex: 1\r\n                        }}\r\n                    >\r\n                        <h3>{title}</h3>\r\n                        <hr />\r\n                        {items.map(item => {\r\n                            return (\r\n                                <DropItem key={item.id} item={item}>\r\n                                    {({\r\n                                        connectDragAndDrop,\r\n                                        isDragging,\r\n                                        isHover,\r\n                                        isOver,\r\n                                        isTmp\r\n                                    }) => {\r\n                                        return (\r\n                                            <div\r\n                                                ref={connectDragAndDrop}\r\n                                                style={{\r\n                                                    opacity: isDragging\r\n                                                        ? 0.5\r\n                                                        : 1,\r\n                                                    padding: 10,\r\n                                                    margin: 5,\r\n                                                    background: \"#f2f2f2\",\r\n                                                    border: \"1px solid #dadada\"\r\n                                                }}\r\n                                            >\r\n                                                {item.title}({item.id})\r\n                                            </div>\r\n                                        );\r\n                                    }}\r\n                                </DropItem>\r\n                            );\r\n                        })}\r\n\r\n                        <DropContainer pid=\"child\" canDrop={() => false}>\r\n                            {({\r\n                                items,\r\n                                monitor,\r\n                                canDrop,\r\n                                connectDropTarget\r\n                            }) => {\r\n                                return (\r\n                                    <div\r\n                                        ref={connectDropTarget}\r\n                                        style={{\r\n                                            height: 300,\r\n                                            overflow: \"auto\",\r\n                                            border: canDrop\r\n                                                ? \"1px solid green\"\r\n                                                : \"1px solid #ccc\",\r\n                                            flex: 1\r\n                                        }}\r\n                                    >\r\n                                        <h3>child</h3>\r\n                                        <hr />\r\n                                        {items.map(item => {\r\n                                            return (\r\n                                                <DropItem\r\n                                                    key={item.id}\r\n                                                    item={item}\r\n                                                >\r\n                                                    {({\r\n                                                        connectDragAndDrop,\r\n                                                        isDragging,\r\n                                                        isHover,\r\n                                                        isOver,\r\n                                                        isTmp\r\n                                                    }) => {\r\n                                                        return (\r\n                                                            <div\r\n                                                                ref={\r\n                                                                    connectDragAndDrop\r\n                                                                }\r\n                                                                style={{\r\n                                                                    opacity: isDragging\r\n                                                                        ? 0.5\r\n                                                                        : 1,\r\n                                                                    padding: 10,\r\n                                                                    margin: 5,\r\n                                                                    background:\r\n                                                                        \"#f2f2f2\",\r\n                                                                    border:\r\n                                                                        \"1px solid #dadada\"\r\n                                                                }}\r\n                                                            >\r\n                                                                {item.title}(\r\n                                                                {item.id})\r\n                                                            </div>\r\n                                                        );\r\n                                                    }}\r\n                                                </DropItem>\r\n                                            );\r\n                                        })}\r\n                                    </div>\r\n                                );\r\n                            }}\r\n                        </DropContainer>\r\n                    </div>\r\n                );\r\n            }}\r\n        </DropContainer>\r\n    );\r\n}\r\n","import TextField from \"./TextField\";\r\nimport TextareaField from \"./TextareaField\";\r\nimport SelectField from \"./SelectField\";\r\nimport CheckboxField from \"./CheckboxField\";\r\nimport RadioField from \"./RadioField\";\r\n\r\nexport default [\r\n    TextField,\r\n    TextareaField,\r\n    SelectField,\r\n    CheckboxField,\r\n    RadioField\r\n];\r\n","export default {\r\n    xtype: \"EX_TEXT_FIELD\",\r\n    title: \"文本\"\r\n};\r\n","export default {\r\n    xtype: \"EX_TEXTAREA_FIELD\",\r\n    title: \"多行文本\"\r\n};\r\n","export default {\r\n    xtype: \"EX_SELECT_FIELD\",\r\n    title: \"单选列表\"\r\n};\r\n","export default {\r\n    xtype: \"EX_CHECKBOX_FIELD\",\r\n    title: \"复选框\"\r\n};\r\n","export default {\r\n    xtype: \"EX_RADIO_FIELD\",\r\n    title: \"单选框\"\r\n};\r\n","import React from \"react\";\r\nimport { Provider, DropContainer, DropItem } from \"@/src\";\r\n\r\nconst dataset = [];\r\n\r\nfor (let i = 0; i < 20; i++) {\r\n    dataset.push({\r\n        id: i + 1,\r\n        title: `${i + 1}. item`\r\n    });\r\n}\r\n\r\nfunction ListItem({ item }) {\r\n    return (\r\n        <DropItem item={item}>\r\n            {({ connectDragAndDrop, isDragging }) => {\r\n                return (\r\n                    <div\r\n                        ref={connectDragAndDrop}\r\n                        style={{\r\n                            opacity: isDragging ? 0.5 : 1,\r\n                            padding: 10,\r\n                            margin: 5,\r\n                            background: \"#f2f2f2\",\r\n                            border: \"1px solid #dadada\"\r\n                        }}\r\n                    >\r\n                        {item.title}\r\n                    </div>\r\n                );\r\n            }}\r\n        </DropItem>\r\n    );\r\n}\r\n\r\nexport default () => {\r\n    const [value, onChange] = React.useState(dataset);\r\n\r\n    return (\r\n        <Provider value={value} onChange={onChange}>\r\n            <DropContainer>\r\n                {({ items, monitor, canDrop, connectDropTarget }) => (\r\n                    <div\r\n                        ref={connectDropTarget}\r\n                        style={{\r\n                            border: \"1px solid #ccc\",\r\n                            borderRadius: 4,\r\n                            padding: 5,\r\n                            width: 270,\r\n                            margin: \"30px auto\",\r\n                            height: \"80%\",\r\n                            overflow: \"auto\"\r\n                        }}\r\n                    >\r\n                        {items.map(item => (\r\n                            <ListItem key={item.id} item={item} />\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </DropContainer>\r\n        </Provider>\r\n    );\r\n};\r\n","import React from \"react\";\r\nimport { Provider, DropContainer, DropItem } from \"@/src\";\r\n\r\nconst dataset = [];\r\n\r\nfor (let i = 0; i < 20; i++) {\r\n    dataset.push({\r\n        id: i + 1,\r\n        title: `${i + 1}. item`\r\n    });\r\n}\r\n\r\nfunction ListItem({ item, index }) {\r\n    return (\r\n        <DropItem item={item}>\r\n            {({ connectDragAndDrop, isDragging }) => {\r\n                return (\r\n                    <div\r\n                        ref={connectDragAndDrop}\r\n                        style={{\r\n                            position: \"absolute\",\r\n                            transition:\r\n                                \"transform .2s cubic-bezier(0.2, 0, 0, 1)\",\r\n                            left: 5,\r\n                            right: 5,\r\n                            transform: `translate(0, ${(30 + 18) * index}px)`,\r\n                            zIndex: isDragging ? 2 : 1,\r\n                            opacity: isDragging ? 0.5 : 1,\r\n                            padding: 10,\r\n                            margin: 5,\r\n                            background: \"#f2f2f2\",\r\n                            border: \"1px solid #dadada\"\r\n                        }}\r\n                    >\r\n                        {item.title}\r\n                    </div>\r\n                );\r\n            }}\r\n        </DropItem>\r\n    );\r\n}\r\n\r\nfunction renderList({ items, monitor, canDrop, connectDropTarget }) {\r\n    const list = [...items];\r\n    list.sort((a, b) => a.id - b.id);\r\n\r\n    const getItemPosition = item => {\r\n        for (let i = 0; i < items.length; i++) {\r\n            const current = items[i];\r\n            if (current.id === item.id) return i;\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div\r\n            ref={connectDropTarget}\r\n            style={{\r\n                position: \"relative\",\r\n                border: \"1px solid #ccc\",\r\n                borderRadius: 4,\r\n                padding: 5,\r\n                width: 270,\r\n                margin: \"30px auto\",\r\n                height: \"80%\",\r\n                overflow: \"auto\"\r\n            }}\r\n        >\r\n            {list.map(item => (\r\n                <ListItem\r\n                    key={item.id}\r\n                    index={getItemPosition(item)}\r\n                    item={item}\r\n                />\r\n            ))}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default () => {\r\n    const [value, onChange] = React.useState(dataset);\r\n\r\n    return (\r\n        <Provider value={value} onChange={onChange}>\r\n            <DropContainer>{renderList}</DropContainer>\r\n        </Provider>\r\n    );\r\n};\r\n","import React from \"react\";\r\nimport {\r\n    Provider,\r\n    DropContainer,\r\n    DropItem,\r\n    DragLayer,\r\n    getEmptyImage\r\n} from \"@/src\";\r\n\r\n/**\r\n * 自定义拖拽层\r\n * 禁用系统自带的拖拽层，使用用户自定义拖拽层\r\n */\r\n\r\nconst dataset = [];\r\n\r\nfor (let i = 0; i < 5; i++) {\r\n    dataset.push({\r\n        pid: \"a\",\r\n        id: i + 1,\r\n        title: `${i + 1}. item`\r\n    });\r\n}\r\n\r\nfor (let i = 5; i < 20; i++) {\r\n    dataset.push({\r\n        pid: \"b\",\r\n        id: i + 1,\r\n        title: `${i + 1}. item`\r\n    });\r\n}\r\n\r\nfunction ListItem({ item }) {\r\n    return (\r\n        <DropItem item={item}>\r\n            {({ connectDragAndDrop, connectDragPreview, isDragging }) => {\r\n                //用空白图片覆盖默认推拽效果\r\n                connectDragPreview(getEmptyImage());\r\n\r\n                return (\r\n                    <div\r\n                        ref={connectDragAndDrop}\r\n                        style={{\r\n                            opacity: isDragging ? 0.4 : 1,\r\n                            padding: 10,\r\n                            margin: 5,\r\n                            background: \"#f2f2f2\",\r\n                            border: \"1px solid #dadada\"\r\n                        }}\r\n                    >\r\n                        {item.title}\r\n                    </div>\r\n                );\r\n            }}\r\n        </DropItem>\r\n    );\r\n}\r\n\r\nfunction ItemDragLayer({ dom, differenceFromInitialOffset }) {\r\n    const [ret, initData] = React.useState(null);\r\n\r\n    React.useEffect(() => {\r\n        const cloneNode = dom.cloneNode(true);\r\n        const rect = dom.getBoundingClientRect();\r\n\r\n        initData({\r\n            rect,\r\n            cloneNode\r\n        });\r\n\r\n        cloneNode.style.position = \"fixed\";\r\n        //重要\r\n        cloneNode.style.pointerEvents = \"none\";\r\n        cloneNode.style.opacity = 1;\r\n        cloneNode.style.left = rect.left + \"px\";\r\n        cloneNode.style.top = rect.top + \"px\";\r\n        cloneNode.style.boxSizing = \"border-box\";\r\n        cloneNode.style.width = rect.width + \"px\";\r\n        cloneNode.style.height = rect.height + \"px\";\r\n\r\n        document.body.appendChild(cloneNode);\r\n        return () => {\r\n            document.body.removeChild(cloneNode);\r\n        };\r\n    }, [dom]);\r\n\r\n    if (ret) {\r\n        const { cloneNode, rect } = ret;\r\n        if (differenceFromInitialOffset) {\r\n            cloneNode.style.left =\r\n                rect.left + differenceFromInitialOffset.x + \"px\";\r\n            cloneNode.style.top =\r\n                rect.top + differenceFromInitialOffset.y + \"px\";\r\n        }\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\nexport default () => {\r\n    const [value, onChange] = React.useState(dataset);\r\n\r\n    return (\r\n        <Provider value={value} onChange={onChange}>\r\n            <div\r\n                style={{\r\n                    position: \"relative\",\r\n                    display: \"flex\",\r\n                    margin: \"30px auto\",\r\n                    height: \"80%\",\r\n                    width: 600\r\n                }}\r\n            >\r\n                <DropContainer pid=\"a\">\r\n                    {({ items, monitor, canDrop, connectDropTarget }) => (\r\n                        <div\r\n                            ref={connectDropTarget}\r\n                            style={{\r\n                                flex: \"1\",\r\n                                border: \"1px solid #ccc\",\r\n                                borderRadius: 4,\r\n                                padding: 5,\r\n                                overflow: \"auto\"\r\n                            }}\r\n                        >\r\n                            {items.map(item => (\r\n                                <ListItem key={item.id} item={item} />\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </DropContainer>\r\n                <div\r\n                    style={{\r\n                        width: 20\r\n                    }}\r\n                ></div>\r\n                <DropContainer pid=\"b\">\r\n                    {({ items, monitor, canDrop, connectDropTarget }) => (\r\n                        <div\r\n                            ref={connectDropTarget}\r\n                            style={{\r\n                                flex: \"1\",\r\n                                border: \"1px solid #ccc\",\r\n                                borderRadius: 4,\r\n                                padding: 5,\r\n                                overflow: \"auto\"\r\n                            }}\r\n                        >\r\n                            {items.map(item => (\r\n                                <ListItem key={item.id} item={item} />\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </DropContainer>\r\n                <DragLayer>\r\n                    {({ isDragging, dom, ...props }) => {\r\n                        if (!isDragging || !dom) return null;\r\n                        return <ItemDragLayer dom={dom} {...props} />;\r\n                    }}\r\n                </DragLayer>\r\n            </div>\r\n        </Provider>\r\n    );\r\n};\r\n","import React from \"react\";\r\nimport {\r\n    Provider,\r\n    DropContainer,\r\n    DropItem,\r\n    DragLayer,\r\n    getEmptyImage\r\n} from \"@/src\";\r\n\r\n/**\r\n * 自定义拖拽层\r\n * 禁用系统自带的拖拽层，使用用户自定义拖拽层\r\n */\r\n\r\nconst dataset = [];\r\n\r\nfor (let i = 0; i < 20; i++) {\r\n    dataset.push({\r\n        pid: \"nostart\",\r\n        id: i + 1,\r\n        title: `${i + 1}. item`\r\n    });\r\n}\r\n\r\nconst ListItem = React.memo(function ListItem({ item }) {\r\n    return (\r\n        <DropItem item={item}>\r\n            {({\r\n                connectDragAndDrop,\r\n                connectDragPreview,\r\n                isDragging,\r\n                hoverDirection\r\n            }) => {\r\n                //用空白图片覆盖默认推拽效果\r\n                connectDragPreview(getEmptyImage());\r\n\r\n                const borderColor = {};\r\n\r\n                if (hoverDirection === \"up\") {\r\n                    borderColor.borderTop = \"1px solid red\";\r\n                    borderColor.borderBottom = \"1px solid  #dadada\";\r\n                }\r\n\r\n                if (hoverDirection === \"down\") {\r\n                    borderColor.borderTop = \"1px solid #dadada\";\r\n                    borderColor.borderBottom = \"1px solid red\";\r\n                }\r\n                if (hoverDirection === \"none\") {\r\n                    borderColor.borderTop = \"1px solid #dadada\";\r\n                    borderColor.borderBottom = \"1px solid #dadada\";\r\n                }\r\n\r\n                return (\r\n                    <div\r\n                        ref={connectDragAndDrop}\r\n                        style={{\r\n                            opacity: isDragging ? 0.4 : 1,\r\n                            padding: 10,\r\n                            margin: 5,\r\n                            background: \"#f2f2f2\",\r\n                            border: \"1px solid #dadada\",\r\n                            ...borderColor\r\n                        }}\r\n                    >\r\n                        {item.title}\r\n                    </div>\r\n                );\r\n            }}\r\n        </DropItem>\r\n    );\r\n});\r\n\r\nfunction ItemDragLayer({ dom, differenceFromInitialOffset }) {\r\n    const [ret, initData] = React.useState(null);\r\n\r\n    React.useEffect(() => {\r\n        const cloneNode = dom.cloneNode(true);\r\n        const rect = dom.getBoundingClientRect();\r\n\r\n        initData({\r\n            rect,\r\n            cloneNode\r\n        });\r\n\r\n        cloneNode.style.position = \"fixed\";\r\n        //重要\r\n        cloneNode.style.pointerEvents = \"none\";\r\n        cloneNode.style.opacity = 0.7;\r\n        cloneNode.style.left = rect.left + \"px\";\r\n        cloneNode.style.top = rect.top + \"px\";\r\n        cloneNode.style.boxSizing = \"border-box\";\r\n        cloneNode.style.width = rect.width + \"px\";\r\n        cloneNode.style.height = rect.height + \"px\";\r\n\r\n        document.body.appendChild(cloneNode);\r\n        return () => {\r\n            document.body.removeChild(cloneNode);\r\n        };\r\n    }, [dom]);\r\n\r\n    if (ret) {\r\n        const { cloneNode, rect } = ret;\r\n        if (differenceFromInitialOffset) {\r\n            cloneNode.style.left =\r\n                rect.left + differenceFromInitialOffset.x + \"px\";\r\n            cloneNode.style.top =\r\n                rect.top + differenceFromInitialOffset.y + \"px\";\r\n        }\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\nexport default () => {\r\n    const [value, onChange] = React.useState(dataset);\r\n\r\n    return (\r\n        <Provider\r\n            value={value}\r\n            onChange={onChange}\r\n            commitAction=\"drop\"\r\n        >\r\n            <div\r\n                style={{\r\n                    position: \"relative\",\r\n                    display: \"flex\",\r\n                    margin: \"30px auto\",\r\n                    height: \"80%\",\r\n                    width: 800\r\n                }}\r\n            >\r\n                <DropContainer pid=\"nostart\">\r\n                    {({ items, monitor, canDrop, connectDropTarget }) => (\r\n                        <div\r\n                            style={{\r\n                                flex: \"1\",\r\n                                border: \"1px solid #ccc\",\r\n                                borderRadius: 4,\r\n                                padding: 5,\r\n                                overflow: \"auto\",\r\n                                display: \"flex\",\r\n                                flexDirection: \"column\"\r\n                            }}\r\n                        >\r\n                            <div>未开始</div>\r\n                            <div\r\n                                ref={connectDropTarget}\r\n                                style={{\r\n                                    flex: \"1\"\r\n                                }}\r\n                            >\r\n                                {items.map(item => (\r\n                                    <ListItem key={item.id} item={item} />\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </DropContainer>\r\n                <div\r\n                    style={{\r\n                        width: 20\r\n                    }}\r\n                ></div>\r\n                <DropContainer pid=\"pending\">\r\n                    {({ items, monitor, canDrop, connectDropTarget }) => (\r\n                        <div\r\n                            style={{\r\n                                flex: \"1\",\r\n                                border: \"1px solid #ccc\",\r\n                                borderRadius: 4,\r\n                                padding: 5,\r\n                                overflow: \"auto\",\r\n                                display: \"flex\",\r\n                                flexDirection: \"column\"\r\n                            }}\r\n                        >\r\n                            <div>处理中</div>\r\n                            <div\r\n                                ref={connectDropTarget}\r\n                                style={{\r\n                                    flex: \"1\",\r\n                                    backgroundColor: canDrop ? \"#eef9f3\" : \"\"\r\n                                }}\r\n                            >\r\n                                {items.map(item => (\r\n                                    <ListItem key={item.id} item={item} />\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </DropContainer>\r\n                <div\r\n                    style={{\r\n                        width: 20\r\n                    }}\r\n                ></div>\r\n                <DropContainer pid=\"done\">\r\n                    {({ items, monitor, canDrop, connectDropTarget }) => (\r\n                        <div\r\n                            style={{\r\n                                flex: \"1\",\r\n                                border: \"1px solid #ccc\",\r\n                                borderRadius: 4,\r\n                                padding: 5,\r\n                                overflow: \"auto\",\r\n                                display: \"flex\",\r\n                                flexDirection: \"column\"\r\n                            }}\r\n                        >\r\n                            <div>已完成</div>\r\n                            <div\r\n                                ref={connectDropTarget}\r\n                                style={{\r\n                                    flex: \"1\",\r\n                                    backgroundColor: canDrop ? \"#eef9f3\" : \"\"\r\n                                }}\r\n                            >\r\n                                {items.map(item => (\r\n                                    <ListItem key={item.id} item={item} />\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </DropContainer>\r\n                <DragLayer>\r\n                    {({ isDragging, dom, ...props }) => {\r\n                        if (!isDragging || !dom) return null;\r\n                        return <ItemDragLayer dom={dom} {...props} />;\r\n                    }}\r\n                </DragLayer>\r\n            </div>\r\n        </Provider>\r\n    );\r\n};\r\n","import React from \"react\";\r\nimport cx from \"classnames\";\r\nimport {\r\n    Provider,\r\n    DropContainer,\r\n    DropItem,\r\n    DragLayer,\r\n    WidgetItem,\r\n    getEmptyImage,\r\n    DropEmptyContainer\r\n} from \"@/src\";\r\nimport fields from \"./fields\";\r\nimport ItemDragLayer from \"./ItemDragLayer\";\r\nimport \"./index.scss\";\r\n\r\nlet fid = 1;\r\n\r\nfunction FieldItem({ field }) {\r\n    return (\r\n        <WidgetItem\r\n            getInstance={() => {\r\n                return {\r\n                    ...field,\r\n                    id: fid++\r\n                };\r\n            }}\r\n        >\r\n            {({ connectDragTarget, connectDragPreview }) => {\r\n                connectDragPreview(getEmptyImage());\r\n                return (\r\n                    <div className=\"field-item\" ref={connectDragTarget}>\r\n                        {field.title}\r\n                    </div>\r\n                );\r\n            }}\r\n        </WidgetItem>\r\n    );\r\n}\r\n\r\nfunction DropFieldContainer({ pid }) {\r\n    const _canDrop = React.useCallback(\r\n        ({ item, model }) => {\r\n            if (pid === \"value\") return true;\r\n\r\n            const items = [\r\n                ...model.getItems(\"column\"),\r\n                ...model.getItems(\"row\")\r\n            ];\r\n            const names = items.map(item => item.name);\r\n            const ids = items.map(item => item.id);\r\n\r\n            //已存在的数据可排序\r\n            if (ids.indexOf(item.id) !== -1) return true;\r\n\r\n            //检测新增数据\r\n            return names.indexOf(item.name) !== -1 ? false : true;\r\n        },\r\n        [pid]\r\n    );\r\n\r\n    return (\r\n        <DropContainer pid={pid} canDrop={_canDrop} axis=\"horizontal\">\r\n            {({ items, connectDropTarget, canDrop, isStrictlyOver }) => {\r\n                return (\r\n                    <div\r\n                        ref={connectDropTarget}\r\n                        className={cx({\r\n                            \"field-drop-list\": true,\r\n                            \"can-drop\": canDrop,\r\n                            \"is-over\": canDrop && isStrictlyOver\r\n                        })}\r\n                    >\r\n                        {items.map(item => {\r\n                            return (\r\n                                <DropItem\r\n                                    canDrop={_canDrop}\r\n                                    item={item}\r\n                                    key={item.id}\r\n                                >\r\n                                    {({\r\n                                        isDragging,\r\n                                        connectDropTarget,\r\n                                        connectDragTarget,\r\n                                        connectDragPreview,\r\n                                        model,\r\n                                        hoverDirection\r\n                                    }) => {\r\n                                        connectDragPreview(getEmptyImage());\r\n                                        return (\r\n                                            <div\r\n                                                style={{\r\n                                                    opacity: isDragging\r\n                                                        ? 0.5\r\n                                                        : 1\r\n                                                }}\r\n                                                className={\r\n                                                    \"field-drop-item hover-dir-\" +\r\n                                                    hoverDirection\r\n                                                }\r\n                                                ref={connectDropTarget}\r\n                                            >\r\n                                                <div\r\n                                                    className=\"field-drop-item-inner\"\r\n                                                    ref={connectDragTarget}\r\n                                                >\r\n                                                    {item.title}\r\n                                                    {pid === \"value\" &&\r\n                                                    item.type === \"number\"\r\n                                                        ? \"(求和)\"\r\n                                                        : \"\"}\r\n                                                    {pid === \"value\" &&\r\n                                                    item.type !== \"number\"\r\n                                                        ? \"(计数)\"\r\n                                                        : \"\"}{\" \"}\r\n                                                    <span\r\n                                                        className=\"item-close\"\r\n                                                        onClick={() => {\r\n                                                            model.removeItem(\r\n                                                                item.id\r\n                                                            );\r\n                                                        }}\r\n                                                    >\r\n                                                        x\r\n                                                    </span>\r\n                                                </div>\r\n                                            </div>\r\n                                        );\r\n                                    }}\r\n                                </DropItem>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                );\r\n            }}\r\n        </DropContainer>\r\n    );\r\n}\r\n\r\nexport default () => {\r\n    const [value, onChange] = React.useState([]);\r\n\r\n    return (\r\n        <Provider\r\n            value={value}\r\n            commitAction=\"drop\"\r\n            onChange={onChange}\r\n        >\r\n            <DropEmptyContainer>\r\n                <div\r\n                    className=\"pivot-container\"\r\n                    style={{\r\n                        position: \"relative\",\r\n                        display: \"flex\",\r\n                        margin: \"30px auto\",\r\n                        height: \"80%\",\r\n                        width: 888\r\n                    }}\r\n                >\r\n                    <div className=\"pivot-field-list\">\r\n                        <div className=\"list-header\">字段列表</div>\r\n                        <div className=\"list-wrapper\">\r\n                            {fields.map(field => (\r\n                                <FieldItem field={field} key={field.name} />\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"pivot-field-result\">\r\n                        <div className=\"result-drop\">\r\n                            <div className=\"drop-row-wrapper\">\r\n                                <div className=\"drop-field-label\">列</div>\r\n                                <div className=\"drop-field-list\">\r\n                                    <DropFieldContainer pid=\"column\" />\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"drop-column-wrapper\">\r\n                                <div className=\"drop-field-label\">行</div>\r\n                                <div className=\"drop-field-list\">\r\n                                    <DropFieldContainer pid=\"row\" />\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"drop-value-wrapper\">\r\n                                <div className=\"drop-field-label\">值</div>\r\n                                <div className=\"drop-field-list\">\r\n                                    <DropFieldContainer pid=\"value\" />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"result-data\">\r\n                            <pre>{JSON.stringify(value, null, 2)}</pre>\r\n                        </div>\r\n                    </div>\r\n                    <DragLayer>\r\n                        {({ isDragging, dom, ...props }) => {\r\n                            if (!isDragging || !dom) return null;\r\n                            return <ItemDragLayer dom={dom} {...props} />;\r\n                        }}\r\n                    </DragLayer>\r\n                </div>\r\n            </DropEmptyContainer>\r\n        </Provider>\r\n    );\r\n};\r\n","export default [\r\n    {\r\n        title: \"日期\",\r\n        type: \"date\",\r\n        name: \"crated_date\"\r\n    },\r\n    {\r\n        title: \"订单来源\",\r\n        type: \"string\",\r\n        name: \"order_from\"\r\n    },\r\n    {\r\n        title: \"用户注册来源\",\r\n        type: \"string\",\r\n        name: \"register_from\"\r\n    },\r\n    {\r\n        title: \"订单地区\",\r\n        type: \"string\",\r\n        name: \"order_area\"\r\n    },\r\n    {\r\n        title: \"支付订单量\",\r\n        type: \"number\",\r\n        name: \"order_pay_total\"\r\n    },\r\n    {\r\n        title: \"被投诉订单量\",\r\n        type: \"number\",\r\n        name: \"order_complaint_total\"\r\n    },\r\n    {\r\n        title: \"取消订单量\",\r\n        type: \"number\",\r\n        name: \"order_cancel_total\"\r\n    }\r\n];\r\n","import React from \"react\";\r\n\r\nexport default function ItemDragLayer({ dom, differenceFromInitialOffset }) {\r\n    const [ret, initData] = React.useState(null);\r\n\r\n    React.useEffect(() => {\r\n        const cloneNode = dom.cloneNode(true);\r\n        const rect = dom.getBoundingClientRect();\r\n\r\n        initData({\r\n            rect,\r\n            cloneNode\r\n        });\r\n\r\n        cloneNode.style.position = \"fixed\";\r\n        //重要\r\n        cloneNode.style.pointerEvents = \"none\";\r\n        cloneNode.style.opacity = 0.7;\r\n        cloneNode.style.left = rect.left + \"px\";\r\n        cloneNode.style.top = rect.top + \"px\";\r\n        cloneNode.style.boxSizing = \"border-box\";\r\n        cloneNode.style.width = rect.width + \"px\";\r\n        cloneNode.style.height = rect.height + \"px\";\r\n        cloneNode.style.padding = \"5px 10px\";\r\n        cloneNode.style.lineHeight = \"20px\";\r\n        cloneNode.style.fontSize = \"12px\";\r\n        cloneNode.style.cursor = \"default\";\r\n\r\n        document.body.appendChild(cloneNode);\r\n        return () => {\r\n            document.body.removeChild(cloneNode);\r\n        };\r\n    }, [dom]);\r\n\r\n    if (ret) {\r\n        const { cloneNode, rect } = ret;\r\n        if (differenceFromInitialOffset) {\r\n            cloneNode.style.left =\r\n                rect.left + differenceFromInitialOffset.x + \"px\";\r\n            cloneNode.style.top =\r\n                rect.top + differenceFromInitialOffset.y + \"px\";\r\n        }\r\n    }\r\n\r\n    return null;\r\n}\r\n","import React from \"react\";\r\nimport cx from \"classnames\";\r\nimport {\r\n    Provider,\r\n    DropContainer,\r\n    DropItem,\r\n    DragLayer,\r\n    WidgetItem,\r\n    getEmptyImage,\r\n    DropEmptyContainer\r\n} from \"@/src\";\r\nimport fields from \"./fields\";\r\nimport ItemDragLayer from \"./ItemDragLayer\";\r\nimport \"./index.scss\";\r\n\r\nlet fid = 1;\r\n\r\nfunction FieldItem({ field }) {\r\n    return (\r\n        <WidgetItem\r\n            getInstance={() => {\r\n                return {\r\n                    ...field,\r\n                    id: fid++\r\n                };\r\n            }}\r\n        >\r\n            {({ connectDragTarget, connectDragPreview }) => {\r\n                connectDragPreview(getEmptyImage());\r\n                return (\r\n                    <div className=\"field-item\" ref={connectDragTarget}>\r\n                        {field.title}\r\n                    </div>\r\n                );\r\n            }}\r\n        </WidgetItem>\r\n    );\r\n}\r\n\r\nfunction DropFieldContainer({ pid }) {\r\n    const _canDrop = React.useCallback(\r\n        ({ item, model }) => {\r\n            if (item.id === \"∑\" && (pid === \"value\" || pid === \"filter\"))\r\n                return false;\r\n\r\n            if (pid === \"value\") return true;\r\n\r\n            const items =\r\n                pid === \"filter\"\r\n                    ? model.getItems(\"filter\")\r\n                    : [...model.getItems(\"column\"), ...model.getItems(\"row\")];\r\n            const names = items.map(item => item.name);\r\n            const ids = items.map(item => item.id);\r\n\r\n            //已存在的数据可排序\r\n            if (ids.indexOf(item.id) !== -1) return true;\r\n\r\n            //检测新增数据\r\n            return names.indexOf(item.name) !== -1 ? false : true;\r\n        },\r\n        [pid]\r\n    );\r\n\r\n    return (\r\n        <DropContainer pid={pid} canDrop={_canDrop}>\r\n            {({ items, connectDropTarget, canDrop, isStrictlyOver, model }) => {\r\n                return (\r\n                    <div\r\n                        ref={connectDropTarget}\r\n                        className={cx({\r\n                            \"field-drop-list\": true,\r\n                            \"can-drop\": canDrop,\r\n                            \"is-over\": canDrop && isStrictlyOver\r\n                        })}\r\n                    >\r\n                        {items.map(item => {\r\n                            return (\r\n                                <DropItem\r\n                                    canDrop={_canDrop}\r\n                                    item={item}\r\n                                    key={item.id}\r\n                                >\r\n                                    {({\r\n                                        isDragging,\r\n                                        connectDropTarget,\r\n                                        connectDragTarget,\r\n                                        connectDragPreview,\r\n                                        model,\r\n                                        hoverDirection\r\n                                    }) => {\r\n                                        connectDragPreview(getEmptyImage());\r\n                                        return (\r\n                                            <div\r\n                                                style={{\r\n                                                    opacity: isDragging\r\n                                                        ? 0.5\r\n                                                        : 1\r\n                                                }}\r\n                                                className={\r\n                                                    \"field-drop-item hover-dir-\" +\r\n                                                    hoverDirection\r\n                                                }\r\n                                                ref={connectDropTarget}\r\n                                            >\r\n                                                <div\r\n                                                    className=\"field-drop-item-inner\"\r\n                                                    ref={connectDragTarget}\r\n                                                >\r\n                                                    {item.title}\r\n                                                    {pid === \"value\" &&\r\n                                                    item.type === \"number\"\r\n                                                        ? \"(求和)\"\r\n                                                        : \"\"}\r\n                                                    {pid === \"value\" &&\r\n                                                    item.type !== \"number\"\r\n                                                        ? \"(计数)\"\r\n                                                        : \"\"}{\" \"}\r\n                                                    {item.id === \"∑\" ? null : (\r\n                                                        <span\r\n                                                            className=\"item-close\"\r\n                                                            onClick={() => {\r\n                                                                model.removeItem(\r\n                                                                    item.id\r\n                                                                );\r\n                                                            }}\r\n                                                        >\r\n                                                            x\r\n                                                        </span>\r\n                                                    )}\r\n                                                </div>\r\n                                            </div>\r\n                                        );\r\n                                    }}\r\n                                </DropItem>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                );\r\n            }}\r\n        </DropContainer>\r\n    );\r\n}\r\n\r\nconst E_VALUE_ITEM = {\r\n    id: \"∑\",\r\n    title: \"∑数值\",\r\n    name: \"∑Values\",\r\n    type: \"number\",\r\n    pid: \"column\"\r\n};\r\n\r\nexport default () => {\r\n    const [value, onChange] = React.useState([]);\r\n\r\n    const handleChange = React.useCallback(\r\n        items => {\r\n            const valueItems = items.filter(item => item.pid === \"value\");\r\n            const shouldShowEValue = valueItems.length > 1;\r\n            const EVI = items.filter(item => item.id === \"∑\");\r\n            if (shouldShowEValue) {\r\n                if (!EVI.length) {\r\n                    items.push({ ...E_VALUE_ITEM });\r\n                }\r\n            } else {\r\n                items = items.filter(item => item.id !== \"∑\");\r\n            }\r\n\r\n            onChange(items);\r\n        },\r\n        [value]\r\n    );\r\n\r\n    return (\r\n        <Provider\r\n            value={value}\r\n            commitAction=\"drop\"\r\n            onChange={handleChange}\r\n        >\r\n            <DropEmptyContainer>\r\n                <div\r\n                    className=\"pivot-container-02\"\r\n                    style={{\r\n                        position: \"relative\",\r\n                        display: \"flex\",\r\n                        margin: \"30px auto\",\r\n                        height: \"80%\",\r\n                        width: 888\r\n                    }}\r\n                >\r\n                    <div className=\"pivot-field-list\">\r\n                        <div className=\"list-header\">字段列表</div>\r\n                        <div className=\"list-wrapper\">\r\n                            {fields.map(field => (\r\n                                <FieldItem field={field} key={field.name} />\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"pivot-field-result\">\r\n                        <div className=\"result-drop\">\r\n                            <div className=\"drop-column-wrapper\">\r\n                                <div className=\"drop-field-label\">筛选</div>\r\n                                <div className=\"drop-field-list\">\r\n                                    <DropFieldContainer pid=\"filter\" />\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"drop-row-wrapper\">\r\n                                <div className=\"drop-field-label\">列</div>\r\n                                <div className=\"drop-field-list\">\r\n                                    <DropFieldContainer pid=\"row\" />\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"drop-column-wrapper\">\r\n                                <div className=\"drop-field-label\">行</div>\r\n                                <div className=\"drop-field-list\">\r\n                                    <DropFieldContainer pid=\"column\" />\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"drop-value-wrapper\">\r\n                                <div className=\"drop-field-label\">值</div>\r\n                                <div className=\"drop-field-list\">\r\n                                    <DropFieldContainer pid=\"value\" />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"result-data\">\r\n                            <pre>{JSON.stringify(value, null, 2)}</pre>\r\n                        </div>\r\n                    </div>\r\n                    <DragLayer>\r\n                        {({ isDragging, dom, ...props }) => {\r\n                            if (!isDragging || !dom) return null;\r\n                            return <ItemDragLayer dom={dom} {...props} />;\r\n                        }}\r\n                    </DragLayer>\r\n                </div>\r\n            </DropEmptyContainer>\r\n        </Provider>\r\n    );\r\n};\r\n","export default [\r\n    {\r\n        title: \"日期\",\r\n        type: \"date\",\r\n        name: \"crated_date\"\r\n    },\r\n    {\r\n        title: \"订单来源\",\r\n        type: \"string\",\r\n        name: \"order_from\"\r\n    },\r\n    {\r\n        title: \"用户注册来源\",\r\n        type: \"string\",\r\n        name: \"register_from\"\r\n    },\r\n    {\r\n        title: \"订单地区\",\r\n        type: \"string\",\r\n        name: \"order_area\"\r\n    },\r\n    {\r\n        title: \"支付订单量\",\r\n        type: \"number\",\r\n        name: \"order_pay_total\"\r\n    },\r\n    {\r\n        title: \"被投诉订单量\",\r\n        type: \"number\",\r\n        name: \"order_complaint_total\"\r\n    },\r\n    {\r\n        title: \"取消订单量\",\r\n        type: \"number\",\r\n        name: \"order_cancel_total\"\r\n    }\r\n];\r\n","import React from \"react\";\r\n\r\nexport default function ItemDragLayer({ dom, differenceFromInitialOffset }) {\r\n    const [ret, initData] = React.useState(null);\r\n\r\n    React.useEffect(() => {\r\n        const cloneNode = dom.cloneNode(true);\r\n        const rect = dom.getBoundingClientRect();\r\n\r\n        initData({\r\n            rect,\r\n            cloneNode\r\n        });\r\n\r\n        cloneNode.style.position = \"fixed\";\r\n        //重要\r\n        cloneNode.style.pointerEvents = \"none\";\r\n        cloneNode.style.opacity = 0.7;\r\n        cloneNode.style.left = rect.left + \"px\";\r\n        cloneNode.style.top = rect.top + \"px\";\r\n        cloneNode.style.boxSizing = \"border-box\";\r\n        cloneNode.style.width = rect.width + \"px\";\r\n        cloneNode.style.height = rect.height + \"px\";\r\n        cloneNode.style.padding = \"5px 10px\";\r\n        cloneNode.style.lineHeight = \"20px\";\r\n        cloneNode.style.fontSize = \"12px\";\r\n        cloneNode.style.cursor = \"default\";\r\n\r\n        document.body.appendChild(cloneNode);\r\n        return () => {\r\n            document.body.removeChild(cloneNode);\r\n        };\r\n    }, [dom]);\r\n\r\n    if (ret) {\r\n        const { cloneNode, rect } = ret;\r\n        if (differenceFromInitialOffset) {\r\n            cloneNode.style.left =\r\n                rect.left + differenceFromInitialOffset.x + \"px\";\r\n            cloneNode.style.top =\r\n                rect.top + differenceFromInitialOffset.y + \"px\";\r\n        }\r\n    }\r\n\r\n    return null;\r\n}\r\n","export const EVENT_TYPE_ADD = \"add\";\r\nexport const EVENT_TYPE_SORT = \"sort\";\r\n\r\nexport const DRAG_DIR_UP = \"up\";\r\nexport const DRAG_DIR_DOWN = \"down\";\r\nexport const DRAG_DIR_LEFT = \"left\";\r\nexport const DRAG_DIR_RIGHT = \"right\";\r\nexport const DRAG_DIR_NONE = \"none\";\r\n\r\nexport const COMMIT_ACTION_AUTO = \"auto\";\r\nexport const COMMIT_ACTION_DROP = \"drop\";\r\n\r\nexport const AXIS_VERTICAL = \"vertical\";\r\nexport const AXIS_HORIZONTAL = \"horizontal\";\r\nexport const AXIS_BOTH = \"both\";\r\n","let state = {\r\n    //part1\r\n    //drag item\r\n    item: null,\r\n    isNew: false,\r\n    canDrop: true,\r\n    //hover container pid\r\n    hoverPid: null,\r\n    //hover item\r\n    hoverItem: null,\r\n    hoverDirection: \"none\",\r\n    //part2\r\n    dragDOMIsRemove: false,\r\n    isDragging: false,\r\n    currentDragDOM: null\r\n};\r\n\r\nfunction setState(newState) {\r\n    state = {\r\n        ...state,\r\n        ...newState\r\n    };\r\n}\r\n\r\nfunction reset() {\r\n    setState({\r\n        item: null,\r\n        isNew: false,\r\n        canDrop: true,\r\n        hoverPid: null,\r\n        hoverItem: null,\r\n        hoverDirection: \"none\",\r\n        dragDOMIsRemove: false,\r\n        isDragging: false,\r\n        currentDragDOM: null\r\n    });\r\n}\r\n\r\nfunction getState() {\r\n    return state;\r\n}\r\n\r\nexport default {\r\n    setState,\r\n    getState,\r\n    reset\r\n};\r\n"],"sourceRoot":""}